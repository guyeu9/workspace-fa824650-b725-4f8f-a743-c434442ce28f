# 贡献指南

## 1. 概述

感谢您考虑为互动式故事游戏编辑器和播放器系统贡献代码！我们欢迎所有类型的贡献，包括但不限于：

- 修复错误
- 新增功能
- 改进文档
- 优化性能
- 翻译内容

## 2. 如何贡献

### 2.1 环境准备

1. **克隆仓库**
   ```bash
   git clone https://your-repo-url.git
   cd project-directory
   ```

2. **安装依赖**
   ```bash
   npm install
   ```

3. **配置环境变量**
   创建 `.env.local` 文件，参考 `.env.example`

4. **初始化数据库**
   ```bash
   npx prisma migrate dev
   npx prisma db seed
   ```

5. **启动开发服务器**
   ```bash
   npm run dev
   ```

### 2.2 开发流程

1. **创建分支**
   ```bash
   git checkout -b feature/your-feature-name
   ```

2. **编写代码**
   - 遵循代码规范
   - 编写测试
   - 确保代码通过所有测试

3. **提交代码**
   ```bash
   git add .
   git commit -m "feat: your commit message"
   git push origin feature/your-feature-name
   ```

4. **创建拉取请求**
   - 访问 GitHub/GitLab 仓库
   - 点击 "New Pull Request"
   - 填写描述和相关问题
   - 提交拉取请求

## 3. 代码规范

### 3.1 TypeScript 规范

- 使用 TypeScript 类型定义
- 避免使用 `any` 类型
- 使用接口定义复杂类型
- 使用 `readonly` 关键字标记不可变属性

### 3.2 React 规范

- 使用函数式组件
- 使用 Hooks 而不是 Class 组件
- 使用 `useCallback` 和 `useMemo` 优化性能
- 使用 `key` 属性优化列表渲染

### 3.3 命名规范

| 类型 | 规范 | 示例 |
|------|------|------|
| 组件 | PascalCase | `GameEditor.tsx` |
| 函数 | camelCase | `handleExport` |
| 变量 | camelCase | `gameData` |
| 常量 | UPPER_SNAKE_CASE | `MAX_FILE_SIZE` |
| 类型 | PascalCase | `GameData` |
| 文件 | kebab-case | `platform-file-download.ts` |

### 3.4 代码格式

- 使用 Prettier 格式化代码
- 缩进使用 2 个空格
- 每行不超过 120 个字符
- 适当的空白行分隔逻辑块

### 3.5 注释规范

- 使用 JSDoc 注释函数和接口
- 注释复杂的逻辑
- 注释不明显的代码行为
- 避免无用的注释

## 4. 提交规范

### 4.1 提交消息格式

```
<类型>: <描述>

[可选的正文]

[可选的脚注]
```

### 4.2 类型

| 类型 | 描述 |
|------|------|
| feat | 新增功能 |
| fix | 修复错误 |
| docs | 文档修改 |
| style | 代码格式修改 |
| refactor | 代码重构 |
| perf | 性能优化 |
| test | 测试相关 |
| build | 构建相关 |
| ci | CI/CD 相关 |
| chore | 其他修改 |
| revert | 回滚提交 |

### 4.3 示例

```
feat: 添加游戏导出功能

- 实现 JSON 格式导出
- 实现 ZIP 格式导出
- 添加导出进度显示

closes #123
```

## 5. 拉取请求流程

### 5.1 拉取请求标题

使用与提交消息相同的格式：
```
<类型>: <描述>
```

### 5.2 拉取请求描述

1. 描述变更内容
2. 说明变更的原因
3. 关联相关问题
4. 提供测试说明
5. 描述预期行为

### 5.3 拉取请求审查

1. 等待至少一位维护者审查
2. 处理审查意见
3. 确保所有测试通过
4. 合并代码

## 6. 问题报告

### 6.1 报告流程

1. 搜索现有问题
2. 点击 "New Issue"
3. 选择问题类型
4. 填写详细描述
5. 提供复现步骤
6. 包含错误日志和截图

### 6.2 问题模板

```
**问题描述**
清晰描述问题

**复现步骤**
1. 步骤 1
2. 步骤 2
3. 步骤 3

**预期行为**
描述预期的行为

**实际行为**
描述实际发生的行为

**环境**
- 操作系统：
- 浏览器：
- 版本：

**日志和截图**
提供相关的错误日志和截图

**额外信息**
其他相关信息
```

## 7. 代码审查

### 7.1 审查标准

- 代码质量
- 功能正确性
- 性能影响
- 安全性
- 可维护性
- 测试覆盖率

### 7.2 审查流程

1. 审查代码变更
2. 提出改进建议
3. 批准或拒绝拉取请求
4. 合并代码

## 8. 测试指南

### 8.1 编写测试

- 使用 Jest 编写测试
- 测试覆盖核心功能
- 编写单元测试和集成测试
- 测试边界情况

### 8.2 运行测试

```bash
npm run test          # 运行所有测试
npm run test:watch   # 监视模式
npm run test:coverage # 覆盖率报告
```

### 8.3 测试规范

- 测试文件命名：`*.test.ts` 或 `*.spec.ts`
- 测试函数命名：`test('description', () => {})`
- 每个测试文件对应一个功能模块

## 9. 文档贡献

### 9.1 文档类型

- 技术文档
- 用户文档
- API 文档
- 部署文档

### 9.2 文档格式

- 使用 Markdown 格式
- 清晰的标题层级
- 适当的示例
- 定期更新

## 10. 行为准则

### 10.1 我们的承诺

作为贡献者和维护者，我们承诺：

- 尊重所有贡献者
- 提供友好和建设性的反馈
- 包容不同的观点和经验
- 聚焦于项目的最佳利益

### 10.2 我们的标准

- 使用包容的语言
- 尊重不同的意见
- 接受建设性批评
- 关注社区的整体利益

### 10.3 违规处理

- 警告
- 临时禁止参与
- 永久禁止参与

## 11. 贡献者行为准则

请阅读并遵守 [行为准则](CODE_OF_CONDUCT.md)。

## 12. 联系我们

- 项目维护者：
- 社区论坛：
- 邮件列表：

## 13. 致谢

感谢所有为项目做出贡献的开发者！

---

**最后更新**: 2026-01-11