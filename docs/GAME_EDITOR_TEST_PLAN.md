# 游戏编辑器测试计划

## 文档信息

**文档版本**: v1.0.0  
**创建日期**: 2026-01-11  
**测试范围**: 游戏文本生成、支线新增、编辑器功能  
**测试对象**: 
- 老版编辑器 (game-editor)
- 增强版编辑器 (enhanced-editor)
- 后端 API (api/games)
- 游戏存储逻辑 (game-store)

---

## 1. 测试概述

### 1.1 测试目标

- 验证游戏文本生成功能的正确性
- 确保支线新增和编辑逻辑的稳定性
- 验证前端编辑器与后端 API 的数据交互
- 确保游戏数据的完整性和一致性
- 验证图片上传和图床集成功能
- 测试游戏导入导出功能

### 1.2 测试范围

#### 前端测试
- 老版编辑器 (game-editor/page.tsx)
- 增强版编辑器 (enhanced-editor/page.tsx)
- 文件上传组件 (file-upload.tsx)
- 游戏库页面 (game-library/page.tsx)

#### 后端测试
- 游戏 API (api/games/route.ts)
- 游戏详情 API (api/games/[id]/route.ts)
- 图片上传 API (api/images/upload/route.ts)
- 游戏存储逻辑 (lib/game-store.ts)

#### 功能测试
- 游戏创建和编辑
- 分支（场景）管理
- 选项管理
- 图片上传和背景设置
- 游戏导入导出
- 数据验证和错误处理

---

## 2. 测试环境

### 2.1 环境配置

| 环境 | URL | 数据库 | 说明 |
|------|-----|--------|------|
| 开发环境 | http://localhost:3000 | PostgreSQL | 本地开发 |
| 测试环境 | http://localhost:3000 | PostgreSQL | 功能测试 |

### 2.2 测试工具

- **测试框架**: Vitest
- **浏览器**: Chrome, Firefox, Safari
- **API 测试**: Postman / curl
- **数据库工具**: Prisma Studio

### 2.3 测试数据准备

#### 测试用户
- 用户名: testuser
- 邮箱: test@example.com
- 密码: test123456

#### 测试游戏数据
- 简单游戏（1个分支，无选项）
- 中等游戏（5个分支，每个2-3个选项）
- 复杂游戏（20个分支，多个循环引用）
- 边界游戏（空数据、超大文本、特殊字符）

---

## 3. 测试用例

### 3.1 游戏创建和基础信息测试

#### TC-001: 创建新游戏 - 老版编辑器

**前置条件**: 用户已登录，访问老版编辑器页面

**测试步骤**:
1. 访问 `/game-editor` 页面
2. 输入游戏标题 "测试游戏001"
3. 输入游戏描述 "这是一个测试游戏"
4. 点击 "添加分支" 按钮
5. 输入章节标题 "第一章"
6. 输入场景描述 "这是第一个场景"
7. 点击 "保存" 按钮

**预期结果**:
- 游戏成功创建
- 分支成功添加
- 数据保存到 IndexedDB
- 显示保存成功提示

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-002: 创建新游戏 - 增强版编辑器

**前置条件**: 用户已登录，访问增强版编辑器页面

**测试步骤**:
1. 访问 `/enhanced-editor` 页面
2. 输入游戏标题 "测试游戏002"
3. 输入游戏描述 "这是一个增强版测试游戏"
4. 输入作者 "测试作者"
5. 点击 "添加分支" 按钮
6. 输入章节标题 "第一章"
7. 输入场景描述 "这是第一个场景"
8. 点击 "保存" 按钮

**预期结果**:
- 游戏成功创建
- 分支成功添加
- 数据保存到 IndexedDB
- 显示保存成功提示
- 状态显示为 "草稿"

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-003: 游戏标题验证 - 空标题

**测试步骤**:
1. 访问编辑器页面
2. 清空游戏标题输入框
3. 尝试保存游戏

**预期结果**:
- 显示错误提示 "游戏标题不能为空"
- 游戏未保存

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-004: 游戏标题验证 - 超长标题

**测试步骤**:
1. 访问编辑器页面
2. 输入超长标题（超过200字符）
3. 尝试保存游戏

**预期结果**:
- 显示错误提示或自动截断
- 游戏保存成功（如果支持截断）

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 3.2 分支（场景）管理测试

#### TC-005: 添加单个分支

**前置条件**: 已创建游戏

**测试步骤**:
1. 点击 "添加分支" 按钮
2. 输入分支ID（自动生成）
3. 输入章节标题 "第二章"
4. 输入场景描述 "这是第二个场景"
5. 点击 "保存"

**预期结果**:
- 新分支成功添加
- 分支ID唯一
- 分支显示在分支列表中
- 数据正确保存

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-006: 批量添加分支

**前置条件**: 已创建游戏

**测试步骤**:
1. 连续点击 "添加分支" 按钮 10 次
2. 为每个分支输入不同的章节标题
3. 点击 "保存"

**预期结果**:
- 所有分支成功添加
- 分支ID全部唯一
- 分支按顺序显示
- 所有数据正确保存

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-007: 编辑分支内容

**前置条件**: 已有分支

**测试步骤**:
1. 点击要编辑的分支
2. 修改章节标题
3. 修改场景描述
4. 点击 "保存"

**预期结果**:
- 分支内容成功更新
- 更新后的内容正确显示
- 数据正确保存到数据库

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-008: 删除分支

**前置条件**: 已有多个分支

**测试步骤**:
1. 点击要删除的分支上的 "删除" 按钮
2. 确认删除操作

**预期结果**:
- 分支成功删除
- 分支从列表中移除
- 相关选项也被删除（如果有）
- 数据正确更新

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-009: 删除分支 - 有选项引用

**前置条件**: 已有分支，其他分支有选项引用此分支

**测试步骤**:
1. 确认分支A被分支B的选项引用
2. 删除分支A

**预期结果**:
- 显示警告提示
- 分支A被删除
- 分支B中引用分支A的选项被标记为无效
- 或自动更新为指向其他分支

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-010: 分支排序

**前置条件**: 已有多个分支

**测试步骤**:
1. 使用拖拽或上移/下移按钮调整分支顺序
2. 保存游戏

**预期结果**:
- 分支顺序成功调整
- 新的顺序正确保存
- 刷新页面后顺序保持不变

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 3.3 选项管理测试

#### TC-011: 添加选项

**前置条件**: 已有分支

**测试步骤**:
1. 选择一个分支
2. 点击 "添加选项" 按钮
3. 输入选项文本 "选择这个选项"
4. 选择目标分支
5. 点击 "保存"

**预期结果**:
- 选项成功添加
- 选项显示在分支的选项列表中
- 目标分支正确设置
- 数据正确保存

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-012: 添加多个选项

**前置条件**: 已有分支

**测试步骤**:
1. 选择一个分支
2. 连续添加 5 个选项
3. 为每个选项设置不同的目标分支
4. 点击 "保存"

**预期结果**:
- 所有选项成功添加
- 每个选项的目标分支正确
- 选项按添加顺序显示
- 所有数据正确保存

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-013: 编辑选项

**前置条件**: 已有选项

**测试步骤**:
1. 选择包含选项的分支
2. 点击要编辑的选项
3. 修改选项文本
4. 修改目标分支
5. 点击 "保存"

**预期结果**:
- 选项内容成功更新
- 更新后的内容正确显示
- 数据正确保存

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-014: 删除选项

**前置条件**: 已有选项

**测试步骤**:
1. 选择包含选项的分支
2. 点击要删除的选项上的 "删除" 按钮
3. 确认删除

**预期结果**:
- 选项成功删除
- 选项从列表中移除
- 数据正确更新

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-015: 选项目标分支验证 - 无效分支

**测试步骤**:
1. 创建一个选项
2. 设置目标分支为不存在的分支ID
3. 尝试保存

**预期结果**:
- 显示错误提示 "目标分支不存在"
- 选项未保存
- 或自动设置为默认分支

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-016: 选项文本验证 - 空文本

**测试步骤**:
1. 创建一个选项
2. 清空选项文本
3. 尝试保存

**预期结果**:
- 显示错误提示 "选项文本不能为空"
- 选项未保存

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-017: 设置选项为结束游戏

**前置条件**: 已有选项

**测试步骤**:
1. 编辑一个选项
2. 勾选 "结束游戏" 选项
3. 保存

**预期结果**:
- 选项成功标记为结束游戏
- 选择此选项后游戏结束
- 数据正确保存

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 3.4 图片上传和背景设置测试

#### TC-018: 上传背景图片 - 支持格式

**前置条件**: 已有分支

**测试步骤**:
1. 选择一个分支
2. 点击 "上传背景图片" 按钮
3. 选择 JPG 格式图片
4. 等待上传完成
5. 保存

**预期结果**:
- 图片成功上传到图床
- 图片URL正确保存
- 背景图片正确显示
- 显示上传成功提示

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-019: 上传背景图片 - 不支持格式

**前置条件**: 已有分支

**测试步骤**:
1. 选择一个分支
2. 点击 "上传背景图片" 按钮
3. 选择不支持的格式（如 .exe, .doc）
4. 尝试上传

**预期结果**:
- 显示错误提示 "不支持的文件格式"
- 图片未上传

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-020: 上传背景图片 - 文件过大

**前置条件**: 已有分支

**测试步骤**:
1. 选择一个分支
2. 点击 "上传背景图片" 按钮
3. 选择超过 10MB 的图片
4. 尝试上传

**预期结果**:
- 显示错误提示 "文件过大，最大支持 10MB"
- 图片未上传

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-021: 上传背景图片 - 缓存机制

**前置条件**: 已有分支

**测试步骤**:
1. 上传一张图片
2. 记录上传时间
3. 再次上传相同的图片
4. 记录第二次上传时间

**预期结果**:
- 第一次上传正常完成
- 第二次上传使用缓存，速度更快
- 两次上传返回相同的URL
- 显示 "使用缓存" 提示

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-022: 删除背景图片

**前置条件**: 分支已有背景图片

**测试步骤**:
1. 选择有背景图片的分支
2. 点击 "删除背景图片" 按钮
3. 确认删除
4. 保存

**预期结果**:
- 背景图片成功删除
- 背景图片URL从数据中移除
- 分支不再显示背景图片

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-023: 图片上传进度显示

**前置条件**: 已有分支

**测试步骤**:
1. 选择一个分支
2. 上传一张较大的图片
3. 观察进度条

**预期结果**:
- 显示上传进度条
- 进度百分比实时更新
- 上传完成后显示 100%
- 显示上传成功提示

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 3.5 游戏导入导出测试

#### TC-024: 导出游戏为 JSON

**前置条件**: 已创建游戏

**测试步骤**:
1. 点击 "导出" 按钮
2. 选择 JSON 格式
3. 保存文件

**预期结果**:
- 文件成功下载
- 文件格式为 JSON
- 文件内容包含完整的游戏数据
- 文件可以正常打开

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-025: 导出游戏为 ZIP

**前置条件**: 已创建游戏，包含图片

**测试步骤**:
1. 点击 "导出" 按钮
2. 选择 ZIP 格式
3. 保存文件

**预期结果**:
- 文件成功下载
- 文件格式为 ZIP
- ZIP 文件包含游戏数据和图片文件
- ZIP 文件可以正常解压

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-026: 导入游戏 - JSON 格式

**前置条件**: 有有效的 JSON 游戏文件

**测试步骤**:
1. 点击 "导入游戏" 按钮
2. 选择 JSON 文件
3. 等待导入完成

**预期结果**:
- 游戏成功导入
- 游戏显示在游戏库中
- 所有分支和选项正确导入
- 图片URL正确加载

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-027: 导入游戏 - ZIP 格式

**前置条件**: 有有效的 ZIP 游戏文件

**测试步骤**:
1. 点击 "导入游戏" 按钮
2. 选择 ZIP 文件
3. 等待导入完成

**预期结果**:
- 游戏成功导入
- 游戏显示在游戏库中
- 所有分支和选项正确导入
- 图片文件正确加载

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-028: 导入游戏 - 无效格式

**测试步骤**:
1. 点击 "导入游戏" 按钮
2. 选择不支持的文件格式（如 .txt, .doc）
3. 尝试导入

**预期结果**:
- 显示错误提示 "不支持的文件格式"
- 游戏未导入

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-029: 导入游戏 - 损坏的文件

**测试步骤**:
1. 创建一个损坏的 JSON 文件
2. 点击 "导入游戏" 按钮
3. 选择损坏的文件
4. 尝试导入

**预期结果**:
- 显示错误提示 "文件格式错误"
- 游戏未导入
- 显示详细的错误信息

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-030: 导入游戏 - 重复ID

**前置条件**: 已有游戏ID为 "game_001"

**测试步骤**:
1. 创建一个游戏文件，ID为 "game_001"
2. 导入此文件

**预期结果**:
- 显示警告提示 "游戏ID已存在"
- 询问是否覆盖或创建新ID
- 根据用户选择执行相应操作

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 3.6 游戏发布和社区测试

#### TC-031: 发布游戏到社区

**前置条件**: 已创建游戏，用户已登录

**测试步骤**:
1. 点击 "发布到社区" 按钮
2. 输入游戏描述
3. 选择封面图片
4. 点击 "发布"

**预期结果**:
- 游戏成功发布
- 游戏显示在社区列表中
- 图片URL验证通过
- 显示发布成功提示

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-032: 发布游戏 - 无效图片URL

**前置条件**: 已创建游戏

**测试步骤**:
1. 点击 "发布到社区" 按钮
2. 输入无效的图片URL（如 javascript:alert(1)）
3. 尝试发布

**预期结果**:
- 显示错误提示 "无效的图片URL"
- 游戏未发布
- 只允许 http:// 和 https:// 协议

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-033: 从社区导入游戏

**前置条件**: 社区中有游戏

**测试步骤**:
1. 浏览社区游戏列表
2. 选择一个游戏
3. 点击 "一键导入" 按钮
4. 等待导入完成

**预期结果**:
- 游戏成功导入到个人游戏库
- 图片从图床加载
- 所有数据正确导入
- 显示导入成功提示

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 3.7 数据验证和错误处理测试

#### TC-034: 游戏数据验证 - 缺少必需字段

**测试步骤**:
1. 创建一个JSON文件，缺少 game_title 字段
2. 尝试导入

**预期结果**:
- 显示验证错误
- 列出缺失的字段
- 游戏未导入

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-035: 游戏数据验证 - 无效的分支ID

**测试步骤**:
1. 创建一个JSON文件，分支ID为空或无效
2. 尝试导入

**预期结果**:
- 显示验证错误
- 指出无效的分支ID
- 游戏未导入

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-036: 游戏数据验证 - 循环引用

**测试步骤**:
1. 创建一个游戏，分支A的选项指向分支B
2. 分支B的选项指向分支A
3. 保存并验证

**预期结果**:
- 游戏成功保存
- 显示警告提示 "检测到循环引用"
- 或自动检测并处理循环

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-037: 网络错误处理 - 上传失败

**测试步骤**:
1. 断开网络连接
2. 尝试上传图片
3. 观察错误提示

**预期结果**:
- 显示友好的错误提示
- 提供重试选项
- 自动降级到本地存储（如果支持）

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-038: 网络错误处理 - 保存失败

**测试步骤**:
1. 断开网络连接
2. 尝试保存游戏
3. 观察错误提示

**预期结果**:
- 显示友好的错误提示
- 游戏数据保存在本地
- 提供稍后同步选项

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 3.8 性能测试

#### TC-039: 大型游戏加载性能

**前置条件**: 有包含100个分支的游戏

**测试步骤**:
1. 打开大型游戏
2. 记录加载时间
3. 测量内存占用

**预期结果**:
- 加载时间 < 3秒
- 内存占用合理
- 界面响应流畅

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-040: 批量操作性能

**前置条件**: 已有游戏

**测试步骤**:
1. 批量添加 50 个分支
2. 记录操作时间
3. 测量内存占用

**预期结果**:
- 操作时间 < 5秒
- 内存占用合理
- 无卡顿现象

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-041: 图片上传性能

**前置条件**: 已有分支

**测试步骤**:
1. 上传 5MB 的图片
2. 记录上传时间
3. 观察进度显示

**预期结果**:
- 上传时间 < 10秒
- 进度显示流畅
- 优化后的图片大小合理

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 3.9 兼容性测试

#### TC-042: 浏览器兼容性 - Chrome

**测试步骤**:
1. 在 Chrome 浏览器中打开编辑器
2. 执行基本操作（创建、编辑、保存）
3. 测试图片上传功能

**预期结果**:
- 所有功能正常
- 界面显示正确
- 无控制台错误

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-043: 浏览器兼容性 - Firefox

**测试步骤**:
1. 在 Firefox 浏览器中打开编辑器
2. 执行基本操作（创建、编辑、保存）
3. 测试图片上传功能

**预期结果**:
- 所有功能正常
- 界面显示正确
- 无控制台错误

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-044: 浏览器兼容性 - Safari

**测试步骤**:
1. 在 Safari 浏览器中打开编辑器
2. 执行基本操作（创建、编辑、保存）
3. 测试图片上传功能

**预期结果**:
- 所有功能正常
- 界面显示正确
- 无控制台错误

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-045: 移动端兼容性

**测试步骤**:
1. 在移动设备上打开编辑器
2. 测试触摸操作
3. 测试响应式布局

**预期结果**:
- 界面适配移动端
- 触摸操作流畅
- 功能正常

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 3.10 安全性测试

#### TC-046: XSS 攻击防护

**测试步骤**:
1. 在游戏标题中输入 `<script>alert('XSS')</script>`
2. 保存游戏
3. 查看游戏列表

**预期结果**:
- 脚本未执行
- 内容被正确转义
- 无安全警告

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-047: SQL 注入防护

**测试步骤**:
1. 在游戏标题中输入 `' OR '1'='1`
2. 保存游戏
3. 检查数据库

**预期结果**:
- 输入被正确处理
- 无 SQL 注入发生
- 数据安全

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-048: 文件上传安全

**测试步骤**:
1. 尝试上传可执行文件（.exe, .sh）
2. 尝试上传包含恶意代码的文件
3. 观察系统行为

**预期结果**:
- 不支持的文件被拒绝
- 文件内容被验证
- 无安全漏洞

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 3.11 用户体验测试

#### TC-049: 撤销/重做功能

**前置条件**: 已有游戏

**测试步骤**:
1. 修改游戏标题
2. 点击 "撤销" 按钮
3. 点击 "重做" 按钮

**预期结果**:
- 撤销后标题恢复原值
- 重做后标题恢复修改值
- 历史记录正确管理

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-050: 自动保存功能

**前置条件**: 已有游戏

**测试步骤**:
1. 修改游戏内容
2. 等待自动保存触发
3. 刷新页面
4. 检查内容是否保留

**预期结果**:
- 内容自动保存
- 刷新后内容保留
- 显示自动保存提示

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-051: 预览功能

**前置条件**: 已有游戏

**测试步骤**:
1. 点击 "预览" 按钮
2. 在预览模式中玩游戏
3. 测试所有选项

**预期结果**:
- 预览模式正常显示
- 所有选项可点击
- 游戏流程正确
- 可以退出预览

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-052: 提示和帮助信息

**测试步骤**:
1. 查看编辑器界面的提示信息
2. 测试帮助文档链接
3. 检查错误提示的友好性

**预期结果**:
- 提示信息清晰
- 帮助文档可访问
- 错误提示友好且有用

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

## 4. 后端 API 测试用例

### 4.1 游戏 API 测试

#### TC-API-001: GET /api/games - 获取游戏列表

**测试步骤**:
1. 发送 GET 请求到 `/api/games`
2. 检查响应状态码
3. 验证响应数据格式

**预期结果**:
- 状态码: 200
- 响应包含游戏列表
- 每个游戏包含必需字段（id, title, description等）

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-API-002: POST /api/games - 创建游戏

**测试步骤**:
1. 准备游戏数据（JSON文件）
2. 发送 POST 请求到 `/api/games`
3. 包含 title, description, coverUrl, file
4. 检查响应

**预期结果**:
- 状态码: 201
- 返回新游戏的 ID
- 游戏成功创建

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-API-003: POST /api/games - 无效的 JSON 文件

**测试步骤**:
1. 准备无效的 JSON 文件
2. 发送 POST 请求到 `/api/games`
3. 检查响应

**预期结果**:
- 状态码: 400
- 返回错误信息 "Invalid JSON content"

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-API-004: POST /api/games - 无效的封面 URL

**测试步骤**:
1. 准备游戏数据
2. 设置 coverUrl 为无效 URL（如 javascript:alert(1)）
3. 发送 POST 请求
4. 检查响应

**预期结果**:
- 状态码: 400
- 返回错误信息 "Invalid cover URL"

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-API-005: POST /api/games - 未授权

**测试步骤**:
1. 不登录
2. 发送 POST 请求到 `/api/games`
3. 检查响应

**预期结果**:
- 状态码: 401
- 返回错误信息 "Unauthorized"

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 4.2 游戏详情 API 测试

#### TC-API-006: GET /api/games/[id] - 获取游戏详情

**测试步骤**:
1. 发送 GET 请求到 `/api/games/{gameId}`
2. 检查响应状态码
3. 验证响应数据

**预期结果**:
- 状态码: 200
- 返回完整的游戏详情
- 包含 jsonData 字段

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-API-007: GET /api/games/[id] - 游戏不存在

**测试步骤**:
1. 发送 GET 请求到 `/api/games/nonexistent-id`
2. 检查响应

**预期结果**:
- 状态码: 404
- 返回错误信息 "Not found"

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

### 4.3 图片上传 API 测试

#### TC-API-008: POST /api/images/upload - 上传图片

**测试步骤**:
1. 准备有效的图片文件
2. 发送 POST 请求到 `/api/images/upload`
3. 包含 file 和 key 参数
4. 检查响应

**预期结果**:
- 状态码: 200
- 返回图片 URL
- 返回优化信息（size, compressionRatio等）

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-API-009: POST /api/images/upload - 不支持的格式

**测试步骤**:
1. 准备不支持的文件格式
2. 发送 POST 请求
3. 检查响应

**预期结果**:
- 状态码: 400
- 返回错误信息

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-API-010: POST /api/images/upload - 文件过大

**测试步骤**:
1. 准备超过 10MB 的文件
2. 发送 POST 请求
3. 检查响应

**预期结果**:
- 状态码: 400
- 返回错误信息 "文件过大"

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

#### TC-API-011: POST /api/images/upload - 频率限制

**测试步骤**:
1. 连续发送 11 次上传请求
2. 检查第 11 次请求的响应

**预期结果**:
- 前 10 次成功
- 第 11 次返回 429
- 返回错误信息 "上传频率过高"

**实际结果**: ___________

**状态**: □ 通过 □ 失败

---

## 5. 测试执行计划

### 5.1 测试阶段

| 阶段 | 时间 | 负责人 | 说明 |
|------|------|--------|------|
| 单元测试 | Day 1 | 开发团队 | 测试各个模块 |
| 集成测试 | Day 2 | 测试团队 | 测试模块间交互 |
| 功能测试 | Day 3-4 | 测试团队 | 执行功能测试用例 |
| 性能测试 | Day 5 | 测试团队 | 执行性能测试用例 |
| 兼容性测试 | Day 6 | 测试团队 | 测试浏览器兼容性 |
| 安全测试 | Day 7 | 安全团队 | 执行安全测试用例 |

### 5.2 测试优先级

**P0 - 必须通过**:
- TC-001, TC-002: 创建新游戏
- TC-005: 添加分支
- TC-011: 添加选项
- TC-018: 上传背景图片
- TC-024: 导出游戏
- TC-026: 导入游戏
- TC-API-001, TC-API-002: API 基本功能

**P1 - 应该通过**:
- TC-006, TC-007: 分支管理
- TC-012, TC-013: 选项管理
- TC-021: 图片缓存
- TC-031: 发布游戏
- TC-API-006: 游戏详情 API

**P2 - 可以延后**:
- TC-039, TC-040: 性能测试
- TC-042, TC-043, TC-044: 兼容性测试
- TC-046, TC-047: 安全测试

### 5.3 缺陷分级

| 级别 | 描述 | 响应时间 |
|------|------|----------|
| 严重 | 系统崩溃、数据丢失 | 立即 |
| 高 | 主要功能不可用 | 4小时内 |
| 中 | 次要功能受影响 | 24小时内 |
| 低 | 界面问题、文字错误 | 48小时内 |

---

## 6. 测试报告模板

### 6.1 测试总结

**测试日期**: ___________  
**测试人员**: ___________  
**测试环境**: ___________

| 模块 | 用例总数 | 通过 | 失败 | 通过率 |
|------|----------|------|------|--------|
| 游戏创建 | 4 |  |  |  |
| 分支管理 | 6 |  |  |  |
| 选项管理 | 7 |  |  |  |
| 图片上传 | 6 |  |  |  |
| 导入导出 | 7 |  |  |  |
| 游戏发布 | 3 |  |  |  |
| 数据验证 | 5 |  |  |  |
| 性能测试 | 3 |  |  |  |
| 兼容性测试 | 4 |  |  |  |
| 安全测试 | 3 |  |  |  |
| 用户体验 | 4 |  |  |  |
| 后端 API | 11 |  |  |  |
| **总计** | **63** |  |  |  |

### 6.2 缺陷列表

| ID | 用例编号 | 描述 | 严重程度 | 状态 |
|----|----------|------|----------|------|
| BUG-001 | TC-XXX |  |  |  |
| BUG-002 | TC-XXX |  |  |  |

### 6.3 测试结论

**是否通过**: □ 是 □ 否

**备注**: ___________

---

## 7. 附录

### 7.1 测试数据示例

#### 简单游戏数据
```json
{
  "game_title": "测试游戏001",
  "description": "这是一个简单的测试游戏",
  "branches": [
    {
      "branch_id": "branch_001",
      "chapter": "第一章",
      "scene_detail": "这是第一个场景",
      "choices": []
    }
  ]
}
```

#### 中等游戏数据
```json
{
  "game_title": "测试游戏002",
  "description": "这是一个中等复杂度的测试游戏",
  "branches": [
    {
      "branch_id": "branch_001",
      "chapter": "第一章",
      "scene_detail": "你在一个神秘的森林中...",
      "choices": [
        {
          "id": "choice_001",
          "choice": "向左走",
          "next_branch": "branch_002"
        },
        {
          "id": "choice_002",
          "choice": "向右走",
          "next_branch": "branch_003"
        }
      ]
    },
    {
      "branch_id": "branch_002",
      "chapter": "第二章",
      "scene_detail": "你发现了一个古老的遗迹...",
      "choices": [
        {
          "id": "choice_003",
          "choice": "进入遗迹",
          "next_branch": "branch_004"
        }
      ]
    }
  ]
}
```

### 7.2 测试检查清单

- [ ] 所有 P0 级测试用例已通过
- [ ] 所有 P1 级测试用例已通过
- [ ] 所有 P2 级测试用例已执行
- [ ] 所有发现的缺陷已记录
- [ ] 所有严重缺陷已修复
- [ ] 性能指标符合要求
- [ ] 安全测试无严重漏洞
- [ ] 兼容性测试通过
- [ ] 文档已更新
- [ ] 测试报告已完成

---

**文档结束**
