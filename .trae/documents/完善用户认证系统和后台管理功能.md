# 游戏编辑器三栏式布局重构计划

## 目标只改动游戏文本编辑器界面

将现有的单列垂直布局重构为IDE风格的三栏式布局，提升编辑效率和用户体验。

## 技术栈

* Next.js 15.3.5 + React 19

* Tailwind CSS + Shadcn/ui

* react-resizable-panels (已安装)

* vaul/drawer (已安装)

## 实施步骤

### 1. 创建三栏布局基础组件

* 使用 `ResizablePanelGroup` 创建可调整大小的三栏布局

* 左侧：场景导航栏（固定宽度，可调整）

* 中间：编辑工作区（主要区域，可调整）

* 右侧：实时预览区（固定宽度，可调整）

### 2. 左侧导航栏（故事结构）

* 场景树形列表（支持展开/折叠）

* 场景类型图标（起始⭐、结局💀/🏆、普通📄）

* 搜索框快速查找场景

* 拖拽排序功能（使用 @dnd-kit）

* 视图切换：列表/导图

### 3. 中间编辑区（场景编辑器）

* 场景基本信息（ID、标题、描述）

* 背景图片上传（带缩略图预览）

* 剧情描述编辑器（支持Markdown）

* 选项卡片式管理

  * 选项文本

  * 智能跳转选择器（下拉搜索）

  * 效果描述

  * 结束游戏选项

  * 折叠/展开功能

### 4. 右侧预览区（游戏模拟器）

* 手机边框样式

* 实时渲染当前场景

* 背景图 + 文字 + 选项按钮

* 独立滚动

* "从当前场景测试"按钮

* 重置/运行控制

### 5. 顶部全局工具栏

* 游戏标题（可编辑）

* 撤销/重做按钮

* 保存/导出/导入

* 测试游戏

* 返回主页

### 6. 响应式设计

* 桌面端：完整三栏显示

* 移动端：中间编辑区为主

  * 左侧导航通过汉堡菜单呼出（Drawer）

  * 右侧预览通过浮动按钮呼出（Drawer）

### 7. 数据管理

* 保持现有的 gameStore 数据结构

* 实时同步编辑内容到预览区

* 撤销/重做历史记录

## 文件变更

* **新建**: `src/components/editor/SceneTree.tsx` (场景树组件)

* **新建**: `src/components/editor/SceneEditor.tsx` (场景编辑器)

* **新建**: `src/components/editor/GamePreview.tsx` (游戏预览器)

* **新建**: `src/components/editor/ChoiceCard.tsx` (选项卡片)

* **修改**: `src/app/game-editor/page.tsx` (重构为三栏布局)

* **可选**: 创建 `src/app/game-editor-v2/page.tsx` (新版本，保留旧版本)

## 优势

* 减少滚动操作，提升编辑效率

* 实时预览，所见即所得

* 结构清晰，符合IDE使用习惯

* 可调整面板大小，适应不同需求

