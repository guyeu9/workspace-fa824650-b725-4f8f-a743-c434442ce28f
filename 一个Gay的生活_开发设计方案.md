# 《一个Gay的生活》游戏开发设计方案

## 1. 项目概述

本项目旨在将《一个Gay的生活》完整剧情与文案脚本转换为可导入游戏引擎的JSON格式，实现基于分支选择的互动叙事游戏。游戏讲述了名校生物博士凌浩在自我认知、家庭压力和感情选择中的挣扎与成长故事。

## 2. 核心设计

### 2.1 游戏结构设计

游戏采用分支叙事结构，包含6个主要章节，根据玩家选择产生9种不同结局。主要分支包括：

- 出柜12杀剧情：第6章核心内容，包含多轮质问与回应
- 骗婚线（2种结局）：妥协结婚后的不同发展
- 扭转治疗线（1种结局）：接受伪科学治疗的后果
- 正向关系线（6种结局）：基于不同伴侣选择的结局

### 2.2 数据结构设计

游戏数据采用JSON格式存储，遵循项目统一的游戏数据格式规范，包含以下核心字段：

- game_title：游戏标题
- description：游戏描述
- author：作者
- tags：标签
- version：版本号
- background_image：背景图片
- background_asset_id：背景资源ID
- branches：分支列表

每个分支包含：

- branch_id：分支ID
- branch_title：分支标题
- content：分支内容
- options：选项列表

每个选项包含：

- option_id：选项ID
- option_text：选项文本
- target_branch_id：目标分支ID
- consequences：后果列表（可选）

每个后果包含：

- type：后果类型（如show_message）
- key：后果键名
- value：后果内容

### 2.3 自我认同分数系统

游戏引入"自我认同分数"机制，分数区间0-100：

- ≥60分：高认同，进入正向关系线
- 30-59分：中等认同，可能进入扭转治疗线
- ＜30分：低认同，进入骗婚线

分数影响游戏进程和结局，玩家选择会导致分数变化。

## 3. 实现细节

### 3.1 分支转换规则

1. **章节内选择转换**：同一章节内的选择直接转换到章节结局
2. **章节间转换**：章节结局转换到下一章节开始
3. **关键抉择转换**：第5章的关键抉择决定后续剧情走向
4. **出柜结果转换**：出柜12杀的结果根据自我认同分数决定后续分支
5. **多轮问答转换**：出柜12杀包含多轮问答，每轮正确回应+5分，错误回应-10分

### 3.2 出柜12杀机制

出柜12杀采用多轮问答机制，每轮20秒倒计时：

- 第1轮：姑姑的质问（同性恋是否是病）
- 第2轮：叔叔的质问（传宗接代是否是本分）
- 第3轮：姑姑的质问（亲戚面前抬不起头）
- 后续轮次：父母/姑姑/叔叔的循环质问（可扩展）

### 3.3 结局触发条件

| 结局类型 | 触发条件 |
|---------|---------|
| 骗婚线结局 | 第5章选择妥协结婚或出柜后自我认同＜30分 |
| 扭转治疗结局 | 出柜后自我认同＜50分，选择妥协接受治疗 |
| 正向关系线结局 | 出柜后自我认同≥60分，家人同意暂时不逼婚 |

## 4. 实现进度

- [x] 完成游戏脚本分析与数据结构设计
- [x] 实现章节1-6的完整分支转换
- [x] 实现出柜12杀的多轮问答机制（当前实现3轮，可扩展）
- [x] 实现3条主要分支和9种结局
- [x] 完成JSON格式转换和验证
- [x] 添加科普文案系统

## 5. 技术实现

### 5.1 JSON转换技术

采用手动转换与验证相结合的方式：

1. 分析原始文案脚本，提取核心剧情和选择分支
2. 按照项目统一的JSON格式规范构建数据结构
3. 实现分支ID和选项ID的命名规则
4. 添加自我认同分数计算逻辑
5. 验证JSON语法正确性

### 5.2 分支ID命名规则

- 章节开始：chapterX_start
- 章节结局：chapterX_ending_a/b/c
- 出柜轮次：chapter6_come_out_roundX
- 分支节点：branch_XXX
- 结局节点：ending_XXX

### 5.3 选项ID命名规则

- 选项前缀：opt_
- 选项描述：清晰反映选项内容
- 示例：opt_agree_blind_date（同意相亲）

## 6. 测试结果

### 6.1 语法验证

使用Node.js JSON.parse验证文件格式正确性：

```
$ node -e "JSON.parse(require('fs').readFileSync('gay_life_final.json', 'utf8')); console.log('JSON is valid!')"
JSON is valid!
```

### 6.2 逻辑验证

- [x] 章节间转换逻辑正确
- [x] 出柜分支转换逻辑正确
- [x] 结局触发条件正确
- [x] 自我认同分数计算逻辑正确

## 7. 部署说明

1. 将生成的JSON文件（gay_life_final.json）导入游戏引擎
2. 配置游戏基本参数（标题、描述等）
3. 确保分支ID和选项ID的唯一性
4. 测试游戏流程，确保所有分支正常转换

## 8. 后续优化

1. 扩展出柜12杀至完整12轮问答
2. 增加背景图片和音效支持
3. 优化分支转换逻辑，增加更丰富的选择后果
4. 完善科普文案系统，增加交互功能
5. 支持多语言版本
6. 添加角色立绘和场景插图

## 9. 注意事项

1. 确保JSON格式严格符合项目规范，避免语法错误
2. 分支ID和选项ID必须唯一
3. 自我认同分数计算要准确
4. 科普文案要准确无误，符合科学事实
5. 保持剧情的完整性和连贯性
6. 尊重LGBTQ+群体，避免刻板印象

## 10. 文件说明

### 10.1 原始文件

- `public/《一个Gay的生活》完整剧情与文案脚本.md`：原始剧情脚本

### 10.2 生成文件

- `gay_life_final.json`：最终转换完成的游戏JSON文件
- `gay_life_fixed.json`：修复过程中的中间版本
- `gay_life_game.json`：游戏格式转换的中间版本
- `gay_life_story.json`：故事内容提取的中间版本
- `generate_gay_life_json.py`：生成JSON的Python脚本

## 11. 更新日志

### 11.1 版本 1.0.0（2026-01-15）

- 完成原始脚本的JSON格式转换
- 实现完整的分支叙事结构
- 实现9种不同结局
- 添加自我认同分数系统
- 完成JSON语法验证
- 创建游戏开发设计方案文档

---

**文档创建时间：** 2026-01-15
**最后更新：** 2026-01-15
**更新人员：** AI助手