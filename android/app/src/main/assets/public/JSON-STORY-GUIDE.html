<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Engine JSON故事格式指南</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #34495e;
            margin-top: 40px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 30px;
        }
        
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        
        code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
        }
        
        ul, ol {
            margin-left: 20px;
        }
        
        li {
            margin: 5px 0;
        }
        
        strong {
            color: #2c3e50;
        }
        
        .back-link {
            display: inline-block;
            margin-top: 30px;
            padding: 10px 20px;
            background: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            text-align: center;
        }
        
        .back-link:hover {
            background: #2980b9;
        }
        
        .example-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .tip-box {
            background: #d1f2eb;
            border: 1px solid #74b9ff;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .warning-box {
            background: #ffeaa7;
            border: 1px solid #fdcb6e;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Text Engine JSON故事格式指南</h1>

        <h2>概述</h2>
        <p>Text Engine 支持通过 JSON 文件创建交互式文字冒险故事。你可以设计多支线剧情，让玩家通过选择指令来决定故事走向，并在不同场景间切换。</p>

        <h2>核心概念</h2>

        <h3>1. 字段兼容性</h3>
        <ul>
            <li><strong>起始位置</strong>: 支持 <code>playerId</code> 或 <code>roomId</code> 字段（推荐使用 <code>roomId</code>）</li>
            <li><strong>数据结构</strong>: 所有字段都是可选的，根据你的故事需要灵活配置</li>
        </ul>

        <h3>2. 剧情推进方式</h3>
        <ul>
            <li><strong>指令驱动</strong>: 玩家输入指令（如 <code>go</code>, <code>talk</code>, <code>take</code>, <code>use</code>）</li>
            <li><strong>选择按钮</strong>: 动态生成上下文相关的操作按钮</li>
            <li><strong>场景切换</strong>: 通过移动、对话或触发事件进入新场景</li>
        </ul>

        <h2>JSON结构详解</h2>

        <h3>基础结构</h3>
        <pre><code>{
  "playerName": "玩家名称",
  "playerId": "start",        // 起始房间ID
  "rooms": [...],            // 房间数组
  "characters": [...]         // 全局角色数组（可选）
}</code></pre>

        <h3>房间 (Room) 结构</h3>
        <pre><code>{
  "id": "room_id",           // 必需：房间唯一标识符
  "name": "房间名称",        // 必需：显示名称
  "desc": [                  // 必需：房间描述数组
    "第一行描述",
    "第二行描述"
  ],
  "img": [                   // 可选：ASCII艺术图
    "┌─────────┐",
    "│   🚪    │",
    "└─────────┘"
  ],
  "items": [...],            // 可选：房间内物品
  "exits": [...],            // 可选：房间出口
  "characters": [...],       // 可选：房间内角色
  "onEnter": [...]           // 可选：进入时触发的事件
}</code></pre>

        <h3>物品 (Item) 结构</h3>
        <pre><code>{
  "name": ["物品名", "别名1", "别名2"],  // 必需：物品名称数组
  "desc": "物品描述",                   // 必需：物品描述
  "isTakeable": true,                   // 可选：是否可拾取（默认false）
  "isHidden": false,                    // 可选：是否隐藏（默认false）
  "onTake": [...],                      // 可选：拾取时触发
  "onUse": [...],                       // 可选：使用时触发
  "isVisible": true                     // 可选：是否可见（默认true）
}</code></pre>

        <h3>角色 (Character) 结构</h3>
        <pre><code>{
  "name": ["角色名", "别名"],            // 必需：角色名称数组
  "id": "char_id",                      // 必需：角色唯一标识符
  "roomId": "room_id",                  // 必需：角色所在房间
  "desc": "角色描述",                   // 必需：角色描述
  "chatLog": [],                        // 可选：对话历史
  "topics": {                           // 必需：对话主题
    "主题关键词": {
      "option": "显示给玩家的选项文本",
      "line": ["回复文本1", "回复文本2"]
    }
  },
  "isHidden": false                     // 可选：是否隐藏（默认false）
}</code></pre>

        <h3>出口 (Exit) 结构</h3>
        <pre><code>{
  "dir": ["方向名", "direction"],        // 必需：方向名称数组
  "id": "target_room_id",              // 必需：目标房间ID
  "block": "阻塞描述",                  // 可选：无法通过时的描述
  "isHidden": false,                    // 可选：是否隐藏出口（默认false）
  "onChoose": [...]                     // 可选：选择此出口时触发
}</code></pre>

        <h2>事件系统</h2>

        <h3>事件类型</h3>
        <ul>
            <li><strong>onEnter</strong>: 玩家进入房间时触发</li>
            <li><strong>onTake</strong>: 玩家拾取物品时触发</li>
            <li><strong>onUse</strong>: 玩家使用物品时触发</li>
            <li><strong>onChoose</strong>: 玩家选择出口时触发</li>
        </ul>

        <h3>事件内容格式</h3>
        <pre><code>// 简单文本
"onEnter": ["你进入了神秘的房间。"]

// 多行文本（会随机选择一行显示）
"onEnter": [
  "你进入了神秘的房间。",
  "房门在你身后缓缓关闭。"
]

// 条件事件（在游戏逻辑中处理）
"onEnter": [
  "if has_item('钥匙'): 你用钥匙打开了门。",
  "else: 门被锁住了，你需要找到钥匙。"
]</code></pre>

        <h2>创作技巧</h2>

        <h3>1. 故事结构设计</h3>
        
        <div class="tip-box">
            <h4>📋 故事规划</h4>
            <ul>
                <li><strong>确定主线剧情</strong>：设计故事的主要目标和最终结局</li>
                <li><strong>创建分支路径</strong>：为不同选择准备多个结局</li>
                <li><strong>房间布局</strong>：画出房间地图和连接关系</li>
                <li><strong>角色设定</strong>：设计NPC的性格和对话内容</li>
            </ul>
        </div>

        <h3>2. 互动设计原则</h3>
        
        <div class="example-box">
            <h4>🎮 良好的用户体验</h4>
            <ul>
                <li><strong>清晰的方向指引</strong>：让玩家明确知道可以去哪里</li>
                <li><strong>有意义的物品</strong>：每个物品都有其作用</li>
                <li><strong>有趣的对话</strong>：角色对话推动剧情发展</li>
                <li><strong>逐步解锁</strong>：随着游戏进展开放新区域</li>
            </ul>
        </div>

        <h3>3. 命名规范</h3>
        
        <div class="warning-box">
            <h4>⚠️ 注意事项</h4>
            <ul>
                <li><strong>唯一ID</strong>：确保所有房间、物品、角色的ID唯一</li>
                <li><strong>描述性命名</strong>：使用有意义的ID，如 "forest_entrance" 而不是 "room1"</li>
                <li><strong>一致性</strong>：保持命名风格的一致性</li>
                <li><strong>避免特殊字符</strong>：ID中只使用字母、数字和下划线</li>
            </ul>
        </div>

        <h2>高级功能</h2>

        <h3>1. 多语言支持</h3>
        <pre><code>// 使用数组支持多种名称
"name": ["钥匙", "key", "鍵匙"],
"dir": ["北", "north", "nord"]</code></pre>

        <h3>2. 条件逻辑</h3>
        <pre><code>// 在描述中使用条件语句
"desc": [
  "你站在房间里。",
  "if has_item('火把'): 火把照亮了房间。",
  "else: 房间很昏暗，你看不太清楚。"
]</code></pre>

        <h3>3. 状态管理</h3>
        <pre><code>// 使用物品作为状态标识器
{
  "name": "剧情进度_第一章",
  "desc": "表示第一章已完成",
  "isHidden": true,
  "isTakeable": false
}</code></pre>

        <h2>测试与调试</h2>

        <h3>1. 验证工具</h3>
        <ul>
            <li><strong>JSON验证器</strong>：检查JSON语法是否正确</li>
            <li><strong>游戏内测试</strong>：导入游戏文件进行实际测试</li>
            <li><strong>浏览器控制台</strong>：查看错误信息和调试日志</li>
        </ul>

        <h3>2. 常见错误</h3>
        
        <div class="warning-box">
            <h4>❌ 避免这些错误</h4>
            <ul>
                <li><strong>JSON语法错误</strong>：缺少逗号、括号不匹配等</li>
                <li><strong>ID重复</strong>：多个房间或物品使用相同ID</li>
                <li><strong>引用错误</strong>：出口指向不存在的房间</li>
                <li><strong>缺少必需字段</strong>：如房间缺少name或desc</li>
            </ul>
        </div>

        <h2>最佳实践</h2>

        <h3>1. 文件组织</h3>
        <pre><code>{
  "// 游戏信息": "注释",
  "title": "我的冒险故事",
  "version": "1.0",
  "author": "作者名",
  "// 游戏数据": "",
  "playerId": "start",
  "rooms": [...]
}</code></pre>

        <h3>2. 版本控制</h3>
        <ul>
            <li>为每个版本添加版本号</li>
            <li>保存不同版本的副本</li>
            <li>记录版本变更日志</li>
        </ul>

        <h3>3. 分享与发布</h3>
        <ul>
            <li><strong>测试完整性</strong>：确保所有路径都能正常通关</li>
            <li><strong>添加说明</strong>：为你的故事添加玩法说明</li>
            <li><strong>获取反馈</strong>：让其他人测试你的故事</li>
            <li><strong>持续改进</strong>：根据反馈优化故事体验</li>
        </ul>

        <div class="tip-box">
            <h4>🌟 创作建议</h4>
            <p>创作交互式故事是一个迭代的过程。不要害怕尝试不同的想法，最重要的是让玩家享受探索的乐趣。从简单的故事开始，逐步增加复杂性和深度。</p>
        </div>

        <h2>参考资源</h2>
        <ul>
            <li><a href="JSON-GUIDE.html" target="_blank">JSON格式说明</a> - 详细的格式文档</li>
            <li><a href="USER-GUIDE.html" target="_blank">使用说明</a> - 游戏操作指南</li>
            <li><a href="json-validator.html" target="_blank">JSON验证器</a> - 在线验证工具</li>
        </ul>

        <a href="index.html" class="back-link">← 返回游戏</a>
    </div>
</body>
</html>