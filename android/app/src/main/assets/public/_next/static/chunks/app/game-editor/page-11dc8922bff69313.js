(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[781],{2533:(e,t,s)=>{"use strict";s.d(t,{BS:()=>y,Ev:()=>n,FS:()=>c,Ho:()=>f,Hv:()=>i,L5:()=>j,Lw:()=>v,Ni:()=>l,Tc:()=>r,Ug:()=>p,fR:()=>u,g6:()=>w,gz:()=>h,mD:()=>m,pp:()=>g,wh:()=>o,wn:()=>d,xD:()=>b,xV:()=>x});var a=s(5155);let r=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("polyline",{points:"12 6 12 12 16 14"})]})},n=e=>{let{className:t=""}=e;return(0,a.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,a.jsx)("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})},l=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,a.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})},o=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"})]})},i=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})},c=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),(0,a.jsx)("polyline",{points:"17 21 17 13 7 13 7 21"}),(0,a.jsx)("polyline",{points:"7 3 7 8 15 8"})]})},d=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,a.jsx)("polyline",{points:"7 10 12 15 17 10"}),(0,a.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})},x=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,a.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),(0,a.jsx)("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),(0,a.jsx)("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})},h=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})},m=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),(0,a.jsx)("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})},u=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("polyline",{points:"5 9 2 12 5 15"}),(0,a.jsx)("polyline",{points:"9 5 12 2 15 5"}),(0,a.jsx)("polyline",{points:"19 9 22 12 19 15"}),(0,a.jsx)("polyline",{points:"15 19 12 22 9 19"}),(0,a.jsx)("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),(0,a.jsx)("line",{x1:"12",y1:"2",x2:"12",y2:"22"})]})},p=e=>{let{className:t=""}=e;return(0,a.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,a.jsx)("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})},g=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("path",{d:"M12 8v8"}),(0,a.jsx)("path",{d:"M8 12h8"})]})},b=e=>{let{className:t=""}=e;return(0,a.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,a.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})})},f=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),(0,a.jsx)("polyline",{points:"9 22 9 12 15 12 15 22"})]})},j=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),(0,a.jsx)("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),(0,a.jsx)("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]})},v=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),(0,a.jsx)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})},y=e=>{let{className:t=""}=e;return(0,a.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,a.jsx)("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})},w=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,a.jsx)("polyline",{points:"14 2 14 8 20 8"}),(0,a.jsx)("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),(0,a.jsx)("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),(0,a.jsx)("polyline",{points:"10 9 9 9 8 9"})]})}},3779:(e,t,s)=>{Promise.resolve().then(s.bind(s,8475))},8475:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(5155),r=s(2115),n=s(2533);function l(){let[e,t]=(0,r.useState)({game_title:"我的故事",description:"这是一个精彩的故事...",branches:[]}),[s,l]=(0,r.useState)(""),[o,i]=(0,r.useState)([]),[c,d]=(0,r.useState)(-1),[x,h]=(0,r.useState)(!1),[m,u]=(0,r.useState)("list"),p=(0,r.useRef)(null),g=e=>{let t=o.slice(0,c+1);t.push(JSON.parse(JSON.stringify(e))),i(t),d(t.length-1)},b=()=>{let s={branch_id:"branch_".concat(Date.now()),chapter:"新章节",scene_detail:"在这里输入场景描述...",choices:[]},a={...e,branches:[...e.branches,s]};t(a),l(s.branch_id),g(a)},f=a=>{let r={...e,branches:e.branches.filter(e=>e.branch_id!==a)};t(r),s===a&&l(""),g(r)},j=(s,a,r)=>{let n={...e,branches:e.branches.map(e=>e.branch_id===s?{...e,[a]:r}:e)};t(n),g(n)},v=s=>{let a={id:"choice_".concat(Date.now()),choice:"新选项",next_branch:"",end_game:!1},r={...e,branches:e.branches.map(e=>e.branch_id===s?{...e,choices:[...e.choices,a]}:e)};t(r),g(r)},y=(s,a,r,n)=>{let l={...e,branches:e.branches.map(e=>e.branch_id===s?{...e,choices:e.choices.map(e=>e.id===a?{...e,[r]:n}:e)}:e)};t(l),g(l)},w=(s,a)=>{let r={...e,branches:e.branches.map(e=>e.branch_id===s?{...e,choices:e.choices.filter(e=>e.id!==a)}:e)};t(r),g(r)},N=e=>{let s=new FileReader;s.onload=e=>{try{var s;let a=JSON.parse(null==(s=e.target)?void 0:s.result);a.game_title&&a.branches&&Array.isArray(a.branches)?(t(a),g(a),alert("导入成功！")):alert("无效的游戏文件格式")}catch(e){alert("JSON解析失败："+e)}},s.readAsText(e)},k=e.branches.find(e=>e.branch_id===s),[_,C]=(0,r.useState)([]),[L,D]=(0,r.useState)(1),[M,S]=(0,r.useState)({x:0,y:0}),[W,B]=(0,r.useState)(!1),[O,z]=(0,r.useState)({x:0,y:0}),[A,E]=(0,r.useState)(!1),[H,V]=(0,r.useState)({x:0,y:0}),[J,Y]=(0,r.useState)(0),[X,F]=(0,r.useState)(1),R=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(0===e.branches.length)return void C([]);let t=[],s=new Set,a=new Map,r=(t,n)=>{if(s.has(t))return;s.add(t),a.has(n)||a.set(n,[]),a.get(n).push(t);let l=e.branches.find(e=>e.branch_id===t);l&&l.choices.forEach(e=>{e.next_branch&&!s.has(e.next_branch)&&r(e.next_branch,n+1)})},n=e.branches[0];n&&r(n.branch_id,0),a.forEach((e,s)=>{let a=400-250*e.length/2+125;e.forEach((e,r)=>{t.push({id:e,x:a+250*r,y:300+200*s})})}),C(t)},[e.branches]);let U=()=>{B(!1)},T=e=>_.find(t=>t.id===e),Q=(e,t,s,a)=>{let r=s-e,n=a-t,l=(e+s)/2,o=(t+a)/2;if(Math.abs(r)>Math.abs(n)){let n=Math.min(Math.abs(r)/2,50);return"M ".concat(e," ").concat(t," L ").concat(l-n," ").concat(t," Q ").concat(l," ").concat(t," ").concat(l," ").concat(o," Q ").concat(l," ").concat(a," ").concat(l+n," ").concat(a," L ").concat(s," ").concat(a)}{let r=Math.min(Math.abs(n)/2,50);return"M ".concat(e," ").concat(t," L ").concat(e," ").concat(o-r," Q ").concat(e," ").concat(o," ").concat(l," ").concat(o," Q ").concat(s," ").concat(o," ").concat(s," ").concat(o+r," L ").concat(s," ").concat(a)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-orange-50/20 to-red-50/20 relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400/5 via-red-400/5 to-pink-400/5 backdrop-blur-sm"}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsx)("div",{className:"bg-white/90 backdrop-blur-xl border-b border-white/50 sticky top-0 z-10 shadow-lg shadow-orange-500/5 pt-[env(safe-area-inset-top)]",children:(0,a.jsx)("div",{className:"px-3 sm:px-5 lg:px-7 py-3 sm:py-4 lg:py-5",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-2 sm:gap-3 lg:gap-4",children:[(0,a.jsxs)("h1",{className:"text-base sm:text-xl lg:text-3xl font-extrabold bg-gradient-to-r from-orange-600 via-red-600 to-pink-600 bg-clip-text text-transparent tracking-tight flex items-center gap-1 sm:gap-1.5 lg:gap-2 whitespace-nowrap",children:[(0,a.jsx)("span",{className:"text-base sm:text-xl lg:text-3xl",children:"\uD83D\uDCDD"}),(0,a.jsx)("span",{children:"文本游戏制作"})]}),(0,a.jsxs)("div",{className:"flex flex-nowrap gap-2 sm:gap-2 lg:gap-3 items-center justify-center w-full sm:w-auto",children:[(0,a.jsx)("button",{onClick:()=>{if(c>0){let e=c-1;d(e),t(JSON.parse(JSON.stringify(o[e])))}},disabled:c<=0,className:"bg-transparent text-slate-600 hover:text-slate-700 border-2 border-slate-600 hover:border-slate-700 transition-all duration-300 font-bold px-3 sm:px-4 lg:px-4 py-2 sm:py-2.5 lg:py-3 rounded-lg text-xs sm:text-sm lg:text-sm flex items-center gap-1 sm:gap-1.5 lg:gap-1.5 shadow-sm hover:shadow-md active:scale-95 min-w-[90px] h-[44px] sm:h-auto justify-center disabled:opacity-50 disabled:cursor-not-allowed active:bg-slate-100",children:"↩️ 撤销"}),(0,a.jsx)("button",{onClick:()=>{if(c<o.length-1){let e=c+1;d(e),t(JSON.parse(JSON.stringify(o[e])))}},disabled:c>=o.length-1,className:"bg-transparent text-slate-600 hover:text-slate-700 border-2 border-slate-600 hover:border-slate-700 transition-all duration-300 font-bold px-3 sm:px-4 lg:px-4 py-2 sm:py-2.5 lg:py-3 rounded-lg text-xs sm:text-sm lg:text-sm flex items-center gap-1 sm:gap-1.5 lg:gap-1.5 shadow-sm hover:shadow-md active:scale-95 min-w-[90px] h-[44px] sm:h-auto justify-center disabled:opacity-50 disabled:cursor-not-allowed active:bg-slate-100",children:"↪️ 重做"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("label",{className:"bg-transparent text-orange-600 hover:text-orange-700 border-2 border-orange-600 hover:border-orange-700 transition-all duration-300 font-bold px-3 sm:px-4 lg:px-4 py-2 sm:py-2.5 lg:py-3 rounded-lg text-xs sm:text-sm lg:text-sm flex items-center gap-1 sm:gap-1.5 lg:gap-1.5 cursor-pointer shadow-sm hover:shadow-md active:scale-95 min-w-[90px] h-[44px] sm:h-auto justify-center active:bg-orange-50",children:[(0,a.jsx)("span",{className:"text-base sm:text-base lg:text-base",children:"\uD83D\uDCE4"}),(0,a.jsx)("span",{className:"inline",children:"导入"})]}),(0,a.jsx)("input",{ref:p,type:"file",accept:".json,application/json",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];s&&N(s)},className:"absolute inset-0 opacity-0 cursor-pointer"})]}),(0,a.jsxs)("button",{onClick:()=>{let t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="".concat(e.game_title,".json"),a.click(),URL.revokeObjectURL(s)},className:"bg-transparent text-orange-600 hover:text-orange-700 border-2 border-orange-600 hover:border-orange-700 transition-all duration-300 font-bold px-3 sm:px-4 lg:px-4 py-2 sm:py-2.5 lg:py-3 rounded-lg text-xs sm:text-sm lg:text-sm flex items-center gap-1 sm:gap-1.5 lg:gap-1.5 shadow-sm hover:shadow-md active:scale-95 min-w-[90px] h-[44px] sm:h-auto justify-center active:bg-orange-50",children:[(0,a.jsx)("span",{className:"text-base sm:text-base lg:text-base",children:"\uD83D\uDCE5"}),(0,a.jsx)("span",{className:"inline",children:"导出"})]}),(0,a.jsxs)("button",{onClick:()=>{sessionStorage.setItem("gameData",JSON.stringify(e)),window.location.href="/"},className:"bg-gradient-to-r from-orange-500 to-red-500 text-white hover:from-orange-600 hover:to-red-600 transition-all duration-300 font-bold px-3 sm:px-4 lg:px-4 py-2 sm:py-2.5 lg:py-3 rounded-lg text-xs sm:text-sm lg:text-sm flex items-center gap-1 sm:gap-1.5 lg:gap-1.5 shadow-sm hover:shadow-md active:scale-95 min-w-[90px] h-[44px] sm:h-auto justify-center active:from-orange-600 active:to-red-600",children:[(0,a.jsx)("span",{className:"text-base sm:text-base lg:text-base",children:"\uD83C\uDFAE"}),(0,a.jsx)("span",{className:"inline",children:"开始游戏"})]}),(0,a.jsxs)("button",{onClick:()=>{window.location.href="/"},className:"bg-blue-500 text-white hover:bg-blue-600 transition-all duration-300 font-bold px-3 sm:px-4 lg:px-4 py-2 sm:py-2.5 lg:py-3 rounded-lg text-xs sm:text-sm lg:text-sm flex items-center gap-1 sm:gap-1.5 lg:gap-1.5 shadow-sm hover:shadow-md active:scale-95 min-w-[90px] h-[44px] sm:h-auto justify-center active:bg-blue-600",children:[(0,a.jsx)(n.Ho,{className:"w-4 h-4 sm:w-5 sm:h-5 lg:w-5 lg:h-5"}),(0,a.jsx)("span",{className:"inline",children:"返回"})]})]})]})})}),(0,a.jsx)("div",{className:"p-3 sm:p-4 lg:p-6 max-w-7xl mx-auto",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-5 lg:gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg shadow-orange-500/10 p-4 sm:p-5 lg:p-6 border border-white/50 sticky top-24",children:[(0,a.jsxs)("h2",{className:"text-lg sm:text-xl font-bold text-slate-800 mb-3 sm:mb-4 flex items-center gap-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDCDA"})," 故事信息"]}),(0,a.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1 sm:mb-2",children:"游戏标题"}),(0,a.jsx)("input",{type:"text",value:e.game_title,onChange:s=>{let a={...e,game_title:s.target.value};t(a),g(a)},className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm sm:text-base"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1 sm:mb-2",children:"游戏描述"}),(0,a.jsx)("textarea",{value:e.description,onChange:s=>{let a={...e,description:s.target.value};t(a),g(a)},rows:4,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm sm:text-base resize-none"})]})]}),(0,a.jsxs)("h2",{className:"text-lg sm:text-xl font-bold text-slate-800 mt-6 mb-3 sm:mb-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:"\uD83C\uDF33"})," 故事分支"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>u("list"),className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-all duration-200 ".concat("list"===m?"bg-gradient-to-r from-orange-500 to-red-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:"\uD83D\uDCCB 列表"}),(0,a.jsx)("button",{onClick:()=>u("graph"),className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-all duration-200 ".concat("graph"===m?"bg-gradient-to-r from-orange-500 to-red-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:"\uD83D\uDDFA️ 导图"})]})]}),(0,a.jsxs)("div",{className:"space-y-2 sm:space-y-3 max-h-[400px] overflow-y-auto",children:[e.branches.map((e,t)=>(0,a.jsxs)("div",{onClick:()=>l(e.branch_id),className:"p-3 rounded-lg cursor-pointer transition-all duration-200 ".concat(s===e.branch_id?"bg-gradient-to-r from-orange-100 to-red-100 border-2 border-orange-500":"bg-slate-50 border-2 border-transparent hover:border-slate-300"),children:[(0,a.jsxs)("div",{className:"font-semibold text-sm sm:text-base text-slate-800 truncate",children:[t+1,". ",e.chapter]}),(0,a.jsxs)("div",{className:"text-xs sm:text-sm text-slate-600 truncate mt-1",children:[e.scene_detail.substring(0,50),"..."]})]},e.branch_id)),(0,a.jsx)("button",{onClick:b,className:"w-full py-3 px-4 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-lg font-bold hover:from-orange-600 hover:to-red-600 transition-all duration-300 shadow-md hover:shadow-lg active:scale-95 text-sm sm:text-base",children:"➕ 添加新分支"})]})]})}),(0,a.jsx)("div",{className:"lg:col-span-2",children:"graph"===m?(0,a.jsxs)("div",{ref:R,className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg shadow-orange-500/10 p-4 sm:p-5 lg:p-6 border border-white/50 overflow-hidden touch-none",onWheel:e=>{e.preventDefault();let t=e.deltaY>0?.9:1.1;D(e=>Math.max(.3,Math.min(3,e*t)))},onMouseDown:e=>{e.target===R.current&&(B(!0),z({x:e.clientX-M.x,y:e.clientY-M.y}))},onMouseMove:e=>{W&&S({x:e.clientX-O.x,y:e.clientY-O.y})},onMouseUp:U,onMouseLeave:U,onTouchStart:e=>{if(1===e.touches.length)E(!0),V({x:e.touches[0].clientX-M.x,y:e.touches[0].clientY-M.y});else if(2===e.touches.length){let t=e.touches[0].clientX-e.touches[1].clientX,s=e.touches[0].clientY-e.touches[1].clientY;Y(Math.sqrt(t*t+s*s)),F(L)}},onTouchMove:e=>{if(e.preventDefault(),1===e.touches.length&&A)S({x:e.touches[0].clientX-H.x,y:e.touches[0].clientY-H.y});else if(2===e.touches.length){let t=e.touches[0].clientX-e.touches[1].clientX,s=e.touches[0].clientY-e.touches[1].clientY,a=Math.sqrt(t*t+s*s)/J;D(e=>Math.max(.3,Math.min(3,X*a)))}},onTouchEnd:()=>{E(!1)},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4 sm:mb-5",children:[(0,a.jsxs)("h2",{className:"text-lg sm:text-xl font-bold text-slate-800 flex items-center gap-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDDFA️"})," 知识导图"]}),(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsx)("button",{onClick:()=>D(e=>Math.max(.3,e-.1)),className:"px-3 py-1.5 bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 transition-all duration-200 text-sm font-medium active:scale-95",children:"➖"}),(0,a.jsxs)("span",{className:"px-3 py-1.5 bg-slate-50 text-slate-600 rounded-lg text-sm font-medium",children:[Math.round(100*L),"%"]}),(0,a.jsx)("button",{onClick:()=>D(e=>Math.min(3,e+.1)),className:"px-3 py-1.5 bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 transition-all duration-200 text-sm font-medium active:scale-95",children:"➕"}),(0,a.jsx)("button",{onClick:()=>{D(1),S({x:0,y:0})},className:"px-3 py-1.5 bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 transition-all duration-200 text-sm font-medium active:scale-95",children:"\uD83D\uDD04"})]})]}),(0,a.jsx)("div",{className:"relative w-full h-[500px] sm:h-[600px] lg:h-[700px] overflow-hidden",children:(0,a.jsxs)("svg",{width:"100%",height:"100%",style:{transform:"translate(".concat(M.x,"px, ").concat(M.y,"px) scale(").concat(L,")"),transformOrigin:"0 0"},children:[(0,a.jsxs)("defs",{children:[(0,a.jsx)("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:(0,a.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#f97316"})}),(0,a.jsx)("filter",{id:"shadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:(0,a.jsx)("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodOpacity:"0.2"})})]}),e.branches.map(e=>{let t=T(e.branch_id);return t?(0,a.jsx)("g",{children:e.choices.map(s=>{if(!s.next_branch)return null;let r=T(s.next_branch);if(!r)return null;let n=Q(t.x,t.y,r.x,r.y);return(0,a.jsx)("path",{d:n,fill:"none",stroke:"#f97316",strokeWidth:"2",markerEnd:"url(#arrowhead)",className:"transition-all duration-300"},"".concat(e.branch_id,"-").concat(s.id))})},e.branch_id):null}),_.map(t=>{let r=e.branches.find(e=>e.branch_id===t.id);return r?(0,a.jsxs)("g",{onClick:()=>l(t.id),className:"cursor-pointer transition-all duration-200 hover:opacity-80",filter:"url(#shadow)",children:[(0,a.jsx)("rect",{x:t.x-80,y:t.y-30,width:"160",height:"60",rx:"8",fill:s===t.id?"#fef3c7":"#ffffff",stroke:s===t.id?"#f97316":"#e2e8f0",strokeWidth:s===t.id?"3":"2",className:"transition-all duration-200"}),(0,a.jsxs)("text",{x:t.x,y:t.y-5,textAnchor:"middle",fontSize:"12",fontWeight:"bold",fill:"#1e293b",className:"select-none",children:[r.chapter.substring(0,15),r.chapter.length>15?"...":""]}),(0,a.jsxs)("text",{x:t.x,y:t.y+15,textAnchor:"middle",fontSize:"10",fill:"#64748b",className:"select-none",children:[r.choices.length," 个选项"]})]},t.id):null})]})})]}):k?(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg shadow-orange-500/10 p-4 sm:p-5 lg:p-6 border border-white/50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4 sm:mb-5",children:[(0,a.jsxs)("h2",{className:"text-lg sm:text-xl font-bold text-slate-800 flex items-center gap-2",children:[(0,a.jsx)("span",{children:"✏️"})," 编辑分支"]}),(0,a.jsxs)("button",{onClick:()=>f(k.branch_id),className:"bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-all duration-300 font-bold text-sm sm:text-base flex items-center gap-1 shadow-md hover:shadow-lg active:scale-95",children:[(0,a.jsx)(n.xV,{className:"w-4 h-4"}),"删除分支"]})]}),(0,a.jsxs)("div",{className:"space-y-4 sm:space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1 sm:mb-2",children:"分支ID"}),(0,a.jsx)("input",{type:"text",value:k.branch_id,onChange:e=>j(k.branch_id,"branch_id",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm sm:text-base bg-slate-50",disabled:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1 sm:mb-2",children:"章节名称"}),(0,a.jsx)("input",{type:"text",value:k.chapter,onChange:e=>j(k.branch_id,"chapter",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm sm:text-base"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1 sm:mb-2",children:"场景描述"}),(0,a.jsx)("textarea",{value:k.scene_detail,onChange:e=>j(k.branch_id,"scene_detail",e.target.value),rows:6,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm sm:text-base resize-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[(0,a.jsxs)("h3",{className:"text-base sm:text-lg font-bold text-slate-800 flex items-center gap-2",children:[(0,a.jsx)("span",{children:"\uD83C\uDFAF"})," 选择选项"]}),(0,a.jsx)("button",{onClick:()=>v(k.branch_id),className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-3 py-2 rounded-lg font-bold hover:from-orange-600 hover:to-red-600 transition-all duration-300 shadow-md hover:shadow-lg active:scale-95 text-sm sm:text-base flex items-center gap-1",children:"➕ 添加选项"})]}),(0,a.jsx)("div",{className:"space-y-3 sm:space-y-4",children:k.choices.map((t,s)=>(0,a.jsxs)("div",{className:"bg-gradient-to-br from-orange-50/50 to-red-50/50 rounded-xl p-4 border border-orange-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("span",{className:"text-sm font-semibold text-slate-700",children:["选项 ",s+1]}),(0,a.jsx)("button",{onClick:()=>w(k.branch_id,t.id),className:"text-red-500 hover:text-red-700 transition-colors text-sm font-medium",children:"删除"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"选项文本"}),(0,a.jsx)("input",{type:"text",value:t.choice,onChange:e=>y(k.branch_id,t.id,"choice",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"跳转到分支"}),(0,a.jsxs)("select",{value:t.next_branch,onChange:e=>y(k.branch_id,t.id,"next_branch",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",children:[(0,a.jsx)("option",{value:"",children:"选择目标分支"},"default"),e.branches.map(e=>(0,a.jsxs)("option",{value:e.branch_id,children:[e.branch_id," - ",e.chapter]},e.branch_id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"效果（可选）"}),(0,a.jsx)("input",{type:"text",value:t.effect||"",onChange:e=>y(k.branch_id,t.id,"effect",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:"例如：获得物品"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"状态更新（可选）"}),(0,a.jsx)("input",{type:"text",value:t.status_update||"",onChange:e=>y(k.branch_id,t.id,"status_update",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:"例如：骚1，浪1，贱1 | +身体10% 心理10%"})]}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:t.end_game||!1,onChange:e=>y(k.branch_id,t.id,"end_game",e.target.checked),className:"w-4 h-4 rounded border-slate-300 text-orange-600 focus:ring-orange-500"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:"结束游戏"})]})})]})]},t.id))})]})]})]}):(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg shadow-orange-500/10 p-8 sm:p-12 lg:p-16 border border-white/50 text-center",children:[(0,a.jsx)("div",{className:"text-6xl sm:text-7xl lg:text-8xl mb-4 sm:mb-6",children:"\uD83D\uDCDD"}),(0,a.jsx)("h3",{className:"text-2xl sm:text-3xl font-bold text-slate-800 mb-3 sm:mb-4",children:"选择一个分支进行编辑"}),(0,a.jsx)("p",{className:"text-base sm:text-lg text-slate-600 mb-6 sm:mb-8",children:"从左侧列表中选择一个分支，或者创建一个新的分支开始编辑你的故事。"}),(0,a.jsx)("button",{onClick:b,className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 sm:px-8 py-3 sm:py-4 rounded-xl font-bold hover:from-orange-600 hover:to-red-600 transition-all duration-300 shadow-lg hover:shadow-xl active:scale-95 text-base sm:text-lg",children:"➕ 创建第一个分支"})]})})]})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(3779)),_N_E=e.O()}]);