<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no">
    <title>å¸ƒå±€ä¿®å¤æµ‹è¯• - å¿«æ·åŒºåŸŸå’Œè¾“å…¥æ¡†ä½ç½®éªŒè¯</title>
    <style>
        :root {
            --bg: #f5f7fa;
            --panel-bg: white;
            --text: #1e293b;
            --muted: #64748b;
            --accent: #6366f1;
            --accent-hover: #5558e3;
            --accent-light: #e0e7ff;
            --border: #e2e8f0;
            --radius: 12px;
            --radius-sm: 8px;
            --font: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            --font-mono: 'SF Mono', Monaco, Inconsolata, 'Roboto Mono', 'Source Code Pro', monospace;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font);
            background: var(--bg);
            color: var(--text);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            padding-top: env(safe-area-inset-top, 0);
            padding-bottom: env(safe-area-inset-bottom, 0);
            padding-left: env(safe-area-inset-left, 0);
            padding-right: env(safe-area-inset-right, 0);
        }

        /* æµ‹è¯•ä¿¡æ¯é¢æ¿ */
        .test-info {
            background: linear-gradient(135deg, var(--accent) 0%, #8b5cf6 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-md);
        }

        .test-info h1 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .test-info .status {
            display: inline-block;
            padding: 8px 16px;
            background: rgba(255,255,255,0.2);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            margin: 5px;
        }

        /* Main Container - ä»ä¸»é¡µé¢å¤åˆ¶çš„å¼ºåŒ–ç‰ˆæœ¬ */
        .container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            position: relative;
            flex-wrap: nowrap;
            isolation: isolate;
            overflow: hidden;
            flex-shrink: 1;
            flex-grow: 1;
            align-items: stretch;
            justify-content: flex-start;
        }

        /* ç¡®ä¿æ‰€æœ‰ä¸»è¦åŒºåŸŸéƒ½æœ‰æ­£ç¡®çš„order - å¼ºåŒ–ç‰ˆæœ¬ */
        .container > #game-title { 
            order: 0; 
            position: relative;
            width: 100%;
            flex-shrink: 0;
        }
        .container > #output { 
            order: 1; 
            position: relative;
            width: 100%;
            flex-shrink: 1;
            z-index: 1;
            max-height: none;
            min-height: 300px;
            flex-grow: 1;
            flex-shrink: 1;
            height: auto;
        }
        .container > #choices { 
            order: 2; 
            position: relative;
            width: 100%;
            flex-shrink: 0;
            z-index: 2;
        }
        .container > .quick-actions { 
            order: 3; 
            position: relative;
            width: 100%;
            flex-shrink: 0;
            z-index: 3;
        }
        .container > #input-area { 
            order: 4; 
            position: relative;
            width: 100%;
            flex-shrink: 0;
            z-index: 4;
        }

        /* æµ‹è¯•ç”¨æ–‡å­—è¾“å‡ºåŒºåŸŸ */
        #output {
            padding: 20px 24px;
            font-family: var(--font-mono);
            font-size: 14px;
            line-height: 1.6;
            background: var(--panel-bg);
            scroll-behavior: smooth;
            border: 2px solid var(--accent-light);
            margin: 10px 0;
            border-radius: var(--radius);
        }

        #output p { 
            margin: 12px 0; 
            padding: 8px;
            background: var(--bg);
            border-radius: var(--radius-sm);
            border-left: 4px solid var(--accent);
        }

        /* åŠ¨æ€é€‰æ‹©æŒ‰é’® */
        #choices {
            padding: 8px 20px;
            background: var(--panel-bg);
            border-top: 1px solid var(--border);
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
            min-height: 50px;
            align-items: center;
            flex-shrink: 0;
            position: relative;
            clear: both;
            z-index: 2;
            border: 2px solid var(--accent-light);
            margin: 10px 0;
            border-radius: var(--radius);
        }

        #choices button {
            padding: 6px 12px;
            background: linear-gradient(135deg, var(--accent) 0%, #8b5cf6 100%);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: var(--shadow-sm);
            white-space: nowrap;
            min-width: 60px;
            max-width: 180px;
            text-overflow: ellipsis;
            overflow: hidden;
            flex: 1 1 auto;
        }

        #choices button:hover { 
            background: linear-gradient(135deg, var(--accent-hover) 0%, #7c3aed 100%); 
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        /* å¿«æ·æŒ‰é’®åŒºåŸŸ - å¼ºåŒ–ç‰ˆæœ¬ */
        .quick-actions {
            display: flex;
            gap: 4px;
            padding: 10px 20px;
            background: var(--panel-bg);
            border-top: 2px solid var(--accent);
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            box-shadow: var(--shadow-sm);
            align-items: center;
            min-height: 50px;
            flex-shrink: 0;
            order: 3;
            width: 100%;
            box-sizing: border-box;
            position: relative;
            clear: both;
            z-index: 3;
            isolation: isolate;
            margin-top: 0 !important;
            float: none;
            margin-bottom: 0;
            border-radius: var(--radius) var(--radius) 0 0;
        }

        .quick-btn {
            padding: 4px 8px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--panel-bg);
            color: var(--muted);
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 3px;
            flex: 0 0 calc(25% - 3px);
            min-width: 45px;
            max-width: calc(25% - 3px);
            text-align: center;
            justify-content: center;
            box-sizing: border-box;
        }

        .quick-btn:hover {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            transform: translateY(-1px);
        }

        /* è¾“å…¥åŒºåŸŸ - å¼ºåŒ–ç‰ˆæœ¬ */
        #input-area {
            padding: 12px 20px;
            background: var(--panel-bg);
            border-top: 2px solid var(--accent);
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex-wrap: wrap;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.06);
            min-height: 120px;
            flex-shrink: 0;
            order: 4;
            position: relative;
            clear: both;
            z-index: 4;
            isolation: isolate;
            margin-top: 0 !important;
            float: none;
            margin-bottom: 0;
            flex-basis: auto;
            align-self: flex-end;
            border-radius: 0 0 var(--radius) var(--radius);
        }

        #input {
            flex: 1;
            min-width: 150px;
            padding: 10px 14px;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-family: var(--font-mono);
            background: var(--panel-bg);
            color: var(--text);
            transition: border-color 0.2s;
        }

        #input:focus { 
            outline: none; 
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-light);
        }

        button {
            padding: 8px 16px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            min-width: 70px;
            flex: 1;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        button:hover { 
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        /* ç§»åŠ¨ç«¯å¼ºåŒ–çº¦æŸ */
        @media (max-width: 900px) {
            .quick-actions {
                gap: 3px;
                padding: 8px 12px;
                display: grid !important;
                grid-template-columns: repeat(4, 1fr) !important;
                grid-template-rows: repeat(2, auto) !important;
                justify-items: stretch !important;
                align-items: stretch !important;
                min-height: auto;
                max-height: none !important;
                width: 100%;
                box-sizing: border-box;
                position: relative !important;
                clear: both !important;
                z-index: 3 !important;
                order: 3 !important;
                float: none !important;
                isolation: isolate !important;
                margin-top: 0 !important;
                margin-bottom: 0 !important;
                grid-row: auto !important;
                grid-column: 1 / -1 !important;
            }
        }

        @media (max-width: 768px) {
            .quick-actions {
                gap: 2px;
                padding: 6px 10px;
                display: grid !important;
                grid-template-columns: repeat(4, 1fr) !important;
                grid-template-rows: repeat(2, auto) !important;
                justify-items: stretch !important;
                align-items: stretch !important;
                min-height: auto;
                max-height: none !important;
                width: 100%;
                box-sizing: border-box;
                position: relative !important;
                clear: both !important;
                z-index: 3 !important;
                order: 3 !important;
                float: none !important;
                isolation: isolate !important;
                margin-top: 0 !important;
                margin-bottom: 0 !important;
                grid-row: auto !important;
                grid-column: 1 / -1 !important;
            }
            
            #input-area {
                padding: 8px 12px;
                gap: 6px;
                flex-direction: column;
                flex-shrink: 0;
                position: relative !important;
                clear: both !important;
                z-index: 4 !important;
                order: 4 !important;
                float: none !important;
                isolation: isolate !important;
                margin-top: 0 !important;
                margin-bottom: 0 !important;
                align-self: flex-end !important;
                flex-basis: auto !important;
                max-height: none !important;
                box-shadow: 0 -2px 8px rgba(0,0,0,0.1) !important;
            }
        }

        @media (max-width: 600px) {
            .quick-actions {
                gap: 1.5px;
                padding: 5px 8px;
                display: grid !important;
                grid-template-columns: repeat(4, 1fr) !important;
                grid-template-rows: repeat(2, auto) !important;
                justify-items: stretch !important;
                align-items: stretch !important;
                min-height: auto;
                max-height: none !important;
                width: 100%;
                box-sizing: border-box;
                position: relative !important;
                clear: both !important;
                z-index: 3 !important;
                order: 3 !important;
                float: none !important;
                isolation: isolate !important;
                margin-top: 0 !important;
                margin-bottom: 0 !important;
                grid-row: auto !important;
                grid-column: 1 / -1 !important;
            }
        }

        @media (max-width: 480px) {
            .quick-actions {
                gap: 1px;
                padding: 4px 6px;
                display: grid !important;
                grid-template-columns: repeat(4, 1fr) !important;
                grid-template-rows: repeat(2, auto) !important;
                justify-items: stretch !important;
                align-items: stretch !important;
                min-height: auto;
                max-height: none !important;
                width: 100%;
                box-sizing: border-box;
                position: relative !important;
                clear: both !important;
                z-index: 3 !important;
                order: 3 !important;
                float: none !important;
                isolation: isolate !important;
                margin-top: 0 !important;
                margin-bottom: 0 !important;
                grid-row: auto !important;
                grid-column: 1 / -1 !important;
            }
        }

        @media (max-width: 360px) {
            .quick-actions {
                gap: 0.5px;
                padding: 3px 4px;
                display: grid !important;
                grid-template-columns: repeat(4, 1fr) !important;
                grid-template-rows: repeat(2, auto) !important;
                justify-items: stretch !important;
                align-items: stretch !important;
                min-height: auto;
                max-height: none !important;
                width: 100%;
                box-sizing: border-box;
                position: relative !important;
                clear: both !important;
                z-index: 3 !important;
                order: 3 !important;
                float: none !important;
                isolation: isolate !important;
                margin-top: 0 !important;
                margin-bottom: 0 !important;
                grid-row: auto !important;
                grid-column: 1 / -1 !important;
            }
        }

        /* æµ‹è¯•æ§åˆ¶é¢æ¿ */
        .test-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            max-width: 300px;
        }

        .test-controls h3 {
            margin: 0 0 10px 0;
            color: var(--accent);
            font-size: 1rem;
        }

        .test-controls button {
            margin: 5px;
            font-size: 11px;
            padding: 6px 12px;
        }

        .layout-status {
            background: var(--bg);
            padding: 10px;
            border-radius: var(--radius-sm);
            margin-top: 10px;
            font-size: 12px;
            font-family: var(--font-mono);
        }

        .status-ok { color: #22c55e; }
        .status-error { color: #ef4444; }
        .status-warning { color: #f59e0b; }
    </style>
</head>
<body>
    <!-- æµ‹è¯•ä¿¡æ¯é¢æ¿ -->
    <div class="test-info">
        <h1>ğŸ§ª å¸ƒå±€ä¿®å¤æµ‹è¯•</h1>
        <div>
            <span class="status">å±å¹•å®½åº¦: <span id="screen-width">-</span>px</span>
            <span class="status">å¸ƒå±€çŠ¶æ€: <span id="layout-status" class="status-ok">æ£€æŸ¥ä¸­...</span></span>
        </div>
        <div style="margin-top: 10px; font-size: 0.9rem;">
            æµ‹è¯•ç›®æ ‡ï¼šç¡®ä¿å¿«æ·åŒºåŸŸå’Œè¾“å…¥æ¡†å§‹ç»ˆç½®äºæ–‡å­—åŒºä¸‹æ–¹
        </div>
    </div>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <!-- æ–‡å­—è¾“å‡ºåŒºåŸŸ -->
        <div id="output">
            <p><strong>ğŸ“ æµ‹è¯•å†…å®¹</strong></p>
            <p>è¿™æ˜¯æ–‡å­—è¾“å‡ºåŒºåŸŸçš„æµ‹è¯•å†…å®¹ã€‚ç”¨äºéªŒè¯å¸ƒå±€æ˜¯å¦æ­£ç¡®ã€‚</p>
            <p>å¿«æ·åŒºåŸŸå’Œè¾“å…¥æ¡†åº”è¯¥å§‹ç»ˆæ˜¾ç¤ºåœ¨è¿™ä¸ªæ–‡å­—åŒºåŸŸçš„ä¸‹æ–¹ã€‚</p>
            <p>æ— è®ºå±å¹•å¤§å°å¦‚ä½•å˜åŒ–ï¼Œå¸ƒå±€é¡ºåºéƒ½åº”è¯¥ä¿æŒä¸å˜ï¼š</p>
            <p>1. æ–‡å­—è¾“å‡ºåŒºåŸŸ (order: 1)</p>
            <p>2. åŠ¨æ€é€‰æ‹©æŒ‰é’® (order: 2)</p>
            <p>3. å¿«æ·æŒ‰é’®åŒºåŸŸ (order: 3)</p>
            <p>4. è¾“å…¥åŒºåŸŸ (order: 4)</p>
            <p>å½“å‰æ—¶é—´: <span id="current-time">-</span></p>
        </div>
        
        <!-- åŠ¨æ€é€‰æ‹©æŒ‰é’® -->
        <div id="choices">
            <button>ğŸ“ å»åŒ—æ–¹</button>
            <button>ğŸ“ å»å—æ–¹</button>
            <button>ğŸ¤² æ‹¿å–é’¥åŒ™</button>
            <button>ğŸ’¬ å¯¹è¯</button>
        </div>

        <!-- å¿«æ·æŒ‰é’®åŒºåŸŸ -->
        <div class="quick-actions">
            <button class="quick-btn">ğŸ‘ï¸ è§‚å¯Ÿ</button>
            <button class="quick-btn">ğŸ“¦ ç‰©å“</button>
            <button class="quick-btn">ğŸ’ èƒŒåŒ…</button>
            <button class="quick-btn">â“ å¸®åŠ©</button>
            <button class="quick-btn">ğŸ’¾ ä¿å­˜</button>
            <button class="quick-btn">ğŸ“‚ è¯»å–</button>
            <button class="quick-btn">ğŸ—‘ï¸ æ¸…é™¤</button>
            <button class="quick-btn">ğŸ“š æŒ‡å—</button>
        </div>

        <!-- è¾“å…¥åŒºåŸŸ -->
        <div id="input-area">
            <input id="input" type="text" placeholder="è¾“å…¥å‘½ä»¤è¿›è¡Œæµ‹è¯•..." autocomplete="off">
            
            <div style="display: flex; gap: 8px;">
                <button id="send">å‘é€</button>
                <button id="test-layout">æµ‹è¯•å¸ƒå±€</button>
                <button id="add-content">æ·»åŠ å†…å®¹</button>
            </div>
        </div>
    </div>

    <!-- æµ‹è¯•æ§åˆ¶é¢æ¿ -->
    <div class="test-controls">
        <h3>ğŸ® æµ‹è¯•æ§åˆ¶</h3>
        <button id="check-layout">æ£€æŸ¥å¸ƒå±€</button>
        <button id="stress-test">å‹åŠ›æµ‹è¯•</button>
        <button id="mobile-test">æ¨¡æ‹Ÿç§»åŠ¨ç«¯</button>
        
        <div class="layout-status" id="layout-details">
            æ­£åœ¨æ£€æŸ¥å¸ƒå±€...
        </div>
    </div>

    <script>
        // æ›´æ–°å±å¹•ä¿¡æ¯
        function updateScreenInfo() {
            document.getElementById('screen-width').textContent = window.innerWidth;
            document.getElementById('current-time').textContent = new Date().toLocaleTimeString();
        }

        // å¸ƒå±€æ£€æŸ¥å‡½æ•°
        function checkLayout() {
            const container = document.querySelector('.container');
            if (!container) return;

            const elements = [
                { selector: '#output', expectedOrder: 1, name: 'æ–‡å­—è¾“å‡ºåŒºåŸŸ' },
                { selector: '#choices', expectedOrder: 2, name: 'åŠ¨æ€é€‰æ‹©æŒ‰é’®' },
                { selector: '.quick-actions', expectedOrder: 3, name: 'å¿«æ·æŒ‰é’®åŒºåŸŸ' },
                { selector: '#input-area', expectedOrder: 4, name: 'è¾“å…¥åŒºåŸŸ' }
            ];

            let status = 'âœ… å¸ƒå±€æ­£ç¡®';
            let statusClass = 'status-ok';
            let details = [];

            elements.forEach(({ selector, expectedOrder, name }) => {
                const element = container.querySelector(selector);
                if (element) {
                    const currentOrder = parseInt(window.getComputedStyle(element).order) || 0;
                    const computedStyle = window.getComputedStyle(element);
                    
                    let elementStatus = 'âœ…';
                    if (currentOrder !== expectedOrder) {
                        elementStatus = 'âŒ';
                        status = 'âŒ å¸ƒå±€é”™è¯¯';
                        statusClass = 'status-error';
                    }
                    
                    details.push(`${elementStatus} ${name}: order=${currentOrder} (æœŸæœ›:${expectedOrder})`);
                    
                    // æ£€æŸ¥å…³é”®CSSå±æ€§
                    if (selector === '.quick-actions' || selector === '#input-area') {
                        const position = computedStyle.position;
                        const clear = computedStyle.clear;
                        const zIndex = computedStyle.zIndex;
                        
                        if (position !== 'relative') {
                            elementStatus = 'âš ï¸';
                            status = 'âš ï¸ å¸ƒå±€è­¦å‘Š';
                            statusClass = 'status-warning';
                        }
                        
                        details.push(`   CSS: position=${position}, clear=${clear}, z-index=${zIndex}`);
                    }
                }
            });

            document.getElementById('layout-status').textContent = status;
            document.getElementById('layout-status').className = statusClass;
            document.getElementById('layout-details').innerHTML = details.join('<br>');

            return { status, statusClass, details };
        }

        // å¼ºåŒ–å¸ƒå±€ä¿®æ­£å‡½æ•°
        function enforceLayoutOrder() {
            const container = document.querySelector('.container');
            if (!container) return;

            const elements = [
                { selector: '#output', expectedOrder: 1, name: 'æ–‡å­—è¾“å‡ºåŒºåŸŸ' },
                { selector: '#choices', expectedOrder: 2, name: 'åŠ¨æ€é€‰æ‹©æŒ‰é’®' },
                { selector: '.quick-actions', expectedOrder: 3, name: 'å¿«æ·æŒ‰é’®åŒºåŸŸ' },
                { selector: '#input-area', expectedOrder: 4, name: 'è¾“å…¥åŒºåŸŸ' }
            ];

            let layoutFixed = false;

            elements.forEach(({ selector, expectedOrder, name }) => {
                const element = container.querySelector(selector);
                if (element) {
                    const currentOrder = parseInt(window.getComputedStyle(element).order) || 0;
                    
                    if (currentOrder !== expectedOrder) {
                        console.warn(`å¸ƒå±€ä¿®æ­£ï¼š${name} çš„ order ä» ${currentOrder} ä¿®æ­£ä¸º ${expectedOrder}`);
                        element.style.order = expectedOrder;
                        element.style.position = 'relative';
                        element.style.width = '100%';
                        element.style.zIndex = expectedOrder;
                        layoutFixed = true;
                    }

                    // é¢å¤–ä¿æŠ¤ï¼šç¡®ä¿å¿«æ·åŒºåŸŸå’Œè¾“å…¥æ¡†æœ‰æ­£ç¡®çš„CSSå±æ€§
                    if (selector === '.quick-actions' || selector === '#input-area') {
                        element.style.clear = 'both';
                        element.style.display = 'block';
                        element.style.boxSizing = 'border-box';
                        element.style.float = 'none';
                        element.style.isolation = 'isolate';
                        element.style.marginTop = '0';
                        element.style.marginBottom = '0';
                        
                        // ç§»åŠ¨ç«¯é¢å¤–ä¿æŠ¤
                        if (window.innerWidth <= 900) {
                            element.style.position = 'relative !important';
                            element.style.clear = 'both !important';
                            element.style.zIndex = parseInt(element.style.zIndex) + 10;
                            
                            // å¯¹äºå¿«æ·åŒºåŸŸï¼Œç¡®ä¿gridå¸ƒå±€æ­£ç¡®
                            if (selector === '.quick-actions') {
                                element.style.display = 'grid !important';
                                element.style.gridTemplateColumns = 'repeat(4, 1fr) !important';
                                element.style.gridTemplateRows = 'repeat(2, auto) !important';
                                element.style.gridRow = 'auto !important';
                                element.style.gridColumn = '1 / -1 !important';
                                element.style.maxHeight = 'none !important';
                            }
                        }
                    }

                    // ç¡®ä¿æ–‡å­—è¾“å‡ºåŒºåŸŸèƒ½å¤Ÿæ­£ç¡®æ‰©å±•
                    if (selector === '#output') {
                        element.style.maxHeight = 'none';
                        element.style.minHeight = '300px';
                        element.style.flexGrow = '1';
                        element.style.flexShrink = '1';
                        element.style.height = 'auto';
                    }
                }
            });

            if (layoutFixed) {
                console.log('å¸ƒå±€ä¿®æ­£å®Œæˆï¼Œç¡®ä¿å¿«æ·åŒºåŸŸå’Œè¾“å…¥æ¡†åœ¨æ–‡å­—åŒºåŸŸä¸‹æ–¹');
                
                // è§¦å‘é‡æ–°å¸ƒå±€
                setTimeout(() => {
                    container.style.display = 'flex';
                    container.style.flexDirection = 'column';
                    container.style.width = '100%';
                    container.style.minHeight = '100vh';
                }, 10);
            }

            return layoutFixed;
        }

        // å‹åŠ›æµ‹è¯•
        function stressTest() {
            const output = document.getElementById('output');
            let contentCount = 0;
            
            const interval = setInterval(() => {
                const p = document.createElement('p');
                p.textContent = `å‹åŠ›æµ‹è¯•å†…å®¹ ${++contentCount} - æ—¶é—´: ${new Date().toLocaleTimeString()}`;
                p.style.background = contentCount % 2 === 0 ? '#fef2f2' : '#f0fdf4';
                p.style.borderLeftColor = contentCount % 2 === 0 ? '#ef4444' : '#22c55e';
                output.appendChild(p);
                output.scrollTop = output.scrollHeight;
                
                // æ¯æ¬¡æ·»åŠ å†…å®¹åæ£€æŸ¥å¸ƒå±€
                enforceLayoutOrder();
                
                if (contentCount >= 20) {
                    clearInterval(interval);
                    setTimeout(checkLayout, 500);
                }
            }, 200);
        }

        // æ¨¡æ‹Ÿç§»åŠ¨ç«¯
        function simulateMobile() {
            const originalWidth = window.innerWidth;
            const viewport = document.querySelector('meta[name="viewport"]');
            
            // ä¸´æ—¶æ”¹å˜viewportæ¥æ¨¡æ‹Ÿç§»åŠ¨ç«¯
            viewport.setAttribute('content', 'width=480, initial-scale=1.0');
            
            setTimeout(() => {
                enforceLayoutOrder();
                checkLayout();
                
                // æ¢å¤åŸå§‹viewport
                setTimeout(() => {
                    viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no');
                }, 3000);
            }, 100);
        }

        // æ·»åŠ æµ‹è¯•å†…å®¹
        function addTestContent() {
            const output = document.getElementById('output');
            const p = document.createElement('p');
            p.innerHTML = `<strong>ğŸ§ª æ–°å¢æµ‹è¯•å†…å®¹</strong><br>
                          æ—¶é—´: ${new Date().toLocaleTimeString()}<br>
                          å±å¹•å®½åº¦: ${window.innerWidth}px<br>
                          è¿™ä¸ªå†…å®¹ç”¨äºæµ‹è¯•å¸ƒå±€æ˜¯å¦ä¿æŒæ­£ç¡®ã€‚<br>
                          å¿«æ·åŒºåŸŸå’Œè¾“å…¥æ¡†åº”è¯¥ä»ç„¶åœ¨ä¸‹æ–¹ã€‚`;
            p.style.background = 'linear-gradient(135deg, #e0e7ff 0%, #f0f9ff 100%)';
            p.style.borderLeftColor = '#6366f1';
            output.appendChild(p);
            output.scrollTop = output.scrollHeight;
            
            setTimeout(enforceLayoutOrder, 100);
        }

        // äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('check-layout').addEventListener('click', () => {
            enforceLayoutOrder();
            checkLayout();
        });

        document.getElementById('stress-test').addEventListener('click', stressTest);
        document.getElementById('mobile-test').addEventListener('click', simulateMobile);
        document.getElementById('add-content').addEventListener('click', addTestContent);

        document.getElementById('send').addEventListener('click', () => {
            const input = document.getElementById('input');
            if (input.value.trim()) {
                const output = document.getElementById('output');
                const p = document.createElement('p');
                p.innerHTML = `<strong>ğŸ“¤ ç”¨æˆ·è¾“å…¥:</strong> ${input.value}<br>
                              æ—¶é—´: ${new Date().toLocaleTimeString()}`;
                p.style.background = '#fef3c7';
                p.style.borderLeftColor = '#f59e0b';
                output.appendChild(p);
                output.scrollTop = output.scrollHeight;
                input.value = '';
                
                setTimeout(enforceLayoutOrder, 100);
            }
        });

        // å®šæœŸæ£€æŸ¥å’Œä¿®æ­£å¸ƒå±€
        function startLayoutMonitoring() {
            // åˆå§‹æ£€æŸ¥
            setTimeout(() => {
                enforceLayoutOrder();
                checkLayout();
            }, 100);
            
            // æ¯1ç§’æ£€æŸ¥ä¸€æ¬¡
            setInterval(() => {
                enforceLayoutOrder();
                updateScreenInfo();
            }, 1000);
            
            // çª—å£å¤§å°æ”¹å˜æ—¶æ£€æŸ¥
            window.addEventListener('resize', () => {
                setTimeout(() => {
                    enforceLayoutOrder();
                    checkLayout();
                }, 50);
                setTimeout(() => {
                    enforceLayoutOrder();
                    checkLayout();
                }, 200);
            });
            
            // æ»šåŠ¨æ—¶æ£€æŸ¥
            let scrollTimer;
            window.addEventListener('scroll', () => {
                clearTimeout(scrollTimer);
                scrollTimer = setTimeout(() => {
                    enforceLayoutOrder();
                }, 150);
            });
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            updateScreenInfo();
            startLayoutMonitoring();
            console.log('å¸ƒå±€æµ‹è¯•é¡µé¢å·²åŠ è½½ï¼Œå¼€å§‹ç›‘æ§å¸ƒå±€çŠ¶æ€');
        });
    </script>
</body>
</html>